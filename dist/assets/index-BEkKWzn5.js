const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-Dsv42Fo6.js","assets/vendor-CUDOwCRt.js"])))=>i.map(i=>d[i]);
import{r as _,a as ei,R as ti,b as W,g as ri,c as X,u as nt,L as Je,d as Zs,e as Qs,f as zs,h as G,N as vt,B as si}from"./vendor-CUDOwCRt.js";import{C as Xr,L as Vs,M as ni,S as ii,T as es,P as ai,a as Ks,b as oi,G as li,F as ci,c as ui,d as di,A as hi,D as fi,U as pi,K as mi,e as gi,f as Hs,g as vi,h as yi,i as bi,j as Ws,X as pr,V as _i,k as xi,l as Js,m as wi,n as ji,o as ki,E as Si,p as Ni}from"./ui-B-FQLDJx.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var Gs={exports:{}},mr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ci=_,Ei=Symbol.for("react.element"),Oi=Symbol.for("react.fragment"),Ti=Object.prototype.hasOwnProperty,Pi=Ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ai={key:!0,ref:!0,__self:!0,__source:!0};function Ys(s,e,t){var r,n={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Ti.call(e,r)&&!Ai.hasOwnProperty(r)&&(n[r]=e[r]);if(s&&s.defaultProps)for(r in e=s.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:Ei,type:s,key:i,ref:a,props:n,_owner:Pi.current}}mr.Fragment=Oi;mr.jsx=Ys;mr.jsxs=Ys;Gs.exports=mr;var l=Gs.exports,Xs,us=ei;Xs=us.createRoot,us.hydrateRoot;function Ir(s,e){return Ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ir(s,e)}function Rt(s,e){s.prototype=Object.create(e.prototype),s.prototype.constructor=s,Ir(s,e)}var $t=function(){function s(){this.listeners=[]}var e=s.prototype;return e.subscribe=function(r){var n=this,i=r||function(){};return this.listeners.push(i),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(a){return a!==i}),n.onUnsubscribe()}},e.hasListeners=function(){return this.listeners.length>0},e.onSubscribe=function(){},e.onUnsubscribe=function(){},s}();function R(){return R=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s},R.apply(null,arguments)}var Xt=typeof window>"u";function Q(){}function Ri(s,e){return typeof s=="function"?s(e):s}function Dr(s){return typeof s=="number"&&s>=0&&s!==1/0}function er(s){return Array.isArray(s)?s:[s]}function en(s,e){return Math.max(s+(e||0)-Date.now(),0)}function Kt(s,e,t){return gr(s)?typeof e=="function"?R({},t,{queryKey:s,queryFn:e}):R({},e,{queryKey:s}):s}function _e(s,e,t){return gr(s)?[R({},e,{queryKey:s}),t]:[s||{},e]}function $i(s,e){if(s===!0&&e===!0||s==null&&e==null)return"all";if(s===!1&&e===!1)return"none";var t=s??!e;return t?"active":"inactive"}function ds(s,e){var t=s.active,r=s.exact,n=s.fetching,i=s.inactive,a=s.predicate,o=s.queryKey,c=s.stale;if(gr(o)){if(r){if(e.queryHash!==ts(o,e.options))return!1}else if(!tr(e.queryKey,o))return!1}var u=$i(t,i);if(u==="none")return!1;if(u!=="all"){var d=e.isActive();if(u==="active"&&!d||u==="inactive"&&d)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||typeof n=="boolean"&&e.isFetching()!==n||a&&!a(e))}function hs(s,e){var t=s.exact,r=s.fetching,n=s.predicate,i=s.mutationKey;if(gr(i)){if(!e.options.mutationKey)return!1;if(t){if(De(e.options.mutationKey)!==De(i))return!1}else if(!tr(e.options.mutationKey,i))return!1}return!(typeof r=="boolean"&&e.state.status==="loading"!==r||n&&!n(e))}function ts(s,e){var t=(e==null?void 0:e.queryKeyHashFn)||De;return t(s)}function De(s){var e=er(s);return Ii(e)}function Ii(s){return JSON.stringify(s,function(e,t){return Lr(t)?Object.keys(t).sort().reduce(function(r,n){return r[n]=t[n],r},{}):t})}function tr(s,e){return tn(er(s),er(e))}function tn(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?!Object.keys(e).some(function(t){return!tn(s[t],e[t])}):!1}function rr(s,e){if(s===e)return s;var t=Array.isArray(s)&&Array.isArray(e);if(t||Lr(s)&&Lr(e)){for(var r=t?s.length:Object.keys(s).length,n=t?e:Object.keys(e),i=n.length,a=t?[]:{},o=0,c=0;c<i;c++){var u=t?c:n[c];a[u]=rr(s[u],e[u]),a[u]===s[u]&&o++}return r===i&&o===r?s:a}return e}function Di(s,e){if(s&&!e||e&&!s)return!1;for(var t in s)if(s[t]!==e[t])return!1;return!0}function Lr(s){if(!fs(s))return!1;var e=s.constructor;if(typeof e>"u")return!0;var t=e.prototype;return!(!fs(t)||!t.hasOwnProperty("isPrototypeOf"))}function fs(s){return Object.prototype.toString.call(s)==="[object Object]"}function gr(s){return typeof s=="string"||Array.isArray(s)}function Li(s){return new Promise(function(e){setTimeout(e,s)})}function ps(s){Promise.resolve().then(s).catch(function(e){return setTimeout(function(){throw e})})}function rn(){if(typeof AbortController=="function")return new AbortController}var Ui=function(s){Rt(e,s);function e(){var r;return r=s.call(this)||this,r.setup=function(n){var i;if(!Xt&&((i=window)!=null&&i.addEventListener)){var a=function(){return n()};return window.addEventListener("visibilitychange",a,!1),window.addEventListener("focus",a,!1),function(){window.removeEventListener("visibilitychange",a),window.removeEventListener("focus",a)}}},r}var t=e.prototype;return t.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},t.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},t.setEventListener=function(n){var i,a=this;this.setup=n,(i=this.cleanup)==null||i.call(this),this.cleanup=n(function(o){typeof o=="boolean"?a.setFocused(o):a.onFocus()})},t.setFocused=function(n){this.focused=n,n&&this.onFocus()},t.onFocus=function(){this.listeners.forEach(function(n){n()})},t.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},e}($t),pt=new Ui,Fi=function(s){Rt(e,s);function e(){var r;return r=s.call(this)||this,r.setup=function(n){var i;if(!Xt&&((i=window)!=null&&i.addEventListener)){var a=function(){return n()};return window.addEventListener("online",a,!1),window.addEventListener("offline",a,!1),function(){window.removeEventListener("online",a),window.removeEventListener("offline",a)}}},r}var t=e.prototype;return t.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},t.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},t.setEventListener=function(n){var i,a=this;this.setup=n,(i=this.cleanup)==null||i.call(this),this.cleanup=n(function(o){typeof o=="boolean"?a.setOnline(o):a.onOnline()})},t.setOnline=function(n){this.online=n,n&&this.onOnline()},t.onOnline=function(){this.listeners.forEach(function(n){n()})},t.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},e}($t),Ht=new Fi;function Mi(s){return Math.min(1e3*Math.pow(2,s),3e4)}function sr(s){return typeof(s==null?void 0:s.cancel)=="function"}var sn=function(e){this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent};function Wt(s){return s instanceof sn}var nn=function(e){var t=this,r=!1,n,i,a,o;this.abort=e.abort,this.cancel=function(f){return n==null?void 0:n(f)},this.cancelRetry=function(){r=!0},this.continueRetry=function(){r=!1},this.continue=function(){return i==null?void 0:i()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(f,p){a=f,o=p});var c=function(p){t.isResolved||(t.isResolved=!0,e.onSuccess==null||e.onSuccess(p),i==null||i(),a(p))},u=function(p){t.isResolved||(t.isResolved=!0,e.onError==null||e.onError(p),i==null||i(),o(p))},d=function(){return new Promise(function(p){i=p,t.isPaused=!0,e.onPause==null||e.onPause()}).then(function(){i=void 0,t.isPaused=!1,e.onContinue==null||e.onContinue()})},h=function f(){if(!t.isResolved){var p;try{p=e.fn()}catch(m){p=Promise.reject(m)}n=function(v){if(!t.isResolved&&(u(new sn(v)),t.abort==null||t.abort(),sr(p)))try{p.cancel()}catch{}},t.isTransportCancelable=sr(p),Promise.resolve(p).then(c).catch(function(m){var v,x;if(!t.isResolved){var w=(v=e.retry)!=null?v:3,T=(x=e.retryDelay)!=null?x:Mi,C=typeof T=="function"?T(t.failureCount,m):T,M=w===!0||typeof w=="number"&&t.failureCount<w||typeof w=="function"&&w(t.failureCount,m);if(r||!M){u(m);return}t.failureCount++,e.onFail==null||e.onFail(t.failureCount,m),Li(C).then(function(){if(!pt.isFocused()||!Ht.isOnline())return d()}).then(function(){r?u(m):f()})}})}};h()},qi=function(){function s(){this.queue=[],this.transactions=0,this.notifyFn=function(t){t()},this.batchNotifyFn=function(t){t()}}var e=s.prototype;return e.batch=function(r){var n;this.transactions++;try{n=r()}finally{this.transactions--,this.transactions||this.flush()}return n},e.schedule=function(r){var n=this;this.transactions?this.queue.push(r):ps(function(){n.notifyFn(r)})},e.batchCalls=function(r){var n=this;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];n.schedule(function(){r.apply(void 0,a)})}},e.flush=function(){var r=this,n=this.queue;this.queue=[],n.length&&ps(function(){r.batchNotifyFn(function(){n.forEach(function(i){r.notifyFn(i)})})})},e.setNotifyFunction=function(r){this.notifyFn=r},e.setBatchNotifyFunction=function(r){this.batchNotifyFn=r},s}(),F=new qi,an=console;function nr(){return an}function Bi(s){an=s}var Zi=function(){function s(t){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.cache=t.cache,this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.initialState=t.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=t.meta,this.scheduleGc()}var e=s.prototype;return e.setOptions=function(r){var n;this.options=R({},this.defaultOptions,r),this.meta=r==null?void 0:r.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},e.setDefaultOptions=function(r){this.defaultOptions=r},e.scheduleGc=function(){var r=this;this.clearGcTimeout(),Dr(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){r.optionalRemove()},this.cacheTime))},e.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},e.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},e.setData=function(r,n){var i,a,o=this.state.data,c=Ri(r,o);return(i=(a=this.options).isDataEqual)!=null&&i.call(a,o,c)?c=o:this.options.structuralSharing!==!1&&(c=rr(o,c)),this.dispatch({data:c,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt}),c},e.setState=function(r,n){this.dispatch({type:"setState",state:r,setStateOptions:n})},e.cancel=function(r){var n,i=this.promise;return(n=this.retryer)==null||n.cancel(r),i?i.then(Q).catch(Q):Promise.resolve()},e.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},e.reset=function(){this.destroy(),this.setState(this.initialState)},e.isActive=function(){return this.observers.some(function(r){return r.options.enabled!==!1})},e.isFetching=function(){return this.state.isFetching},e.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(r){return r.getCurrentResult().isStale})},e.isStaleByTime=function(r){return r===void 0&&(r=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!en(this.state.dataUpdatedAt,r)},e.onFocus=function(){var r,n=this.observers.find(function(i){return i.shouldFetchOnWindowFocus()});n&&n.refetch(),(r=this.retryer)==null||r.continue()},e.onOnline=function(){var r,n=this.observers.find(function(i){return i.shouldFetchOnReconnect()});n&&n.refetch(),(r=this.retryer)==null||r.continue()},e.addObserver=function(r){this.observers.indexOf(r)===-1&&(this.observers.push(r),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:r}))},e.removeObserver=function(r){this.observers.indexOf(r)!==-1&&(this.observers=this.observers.filter(function(n){return n!==r}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:r}))},e.getObserversCount=function(){return this.observers.length},e.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},e.fetch=function(r,n){var i=this,a,o,c;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var u;return(u=this.retryer)==null||u.continueRetry(),this.promise}}if(r&&this.setOptions(r),!this.options.queryFn){var d=this.observers.find(function(T){return T.options.queryFn});d&&this.setOptions(d.options)}var h=er(this.queryKey),f=rn(),p={queryKey:h,pageParam:void 0,meta:this.meta};Object.defineProperty(p,"signal",{enumerable:!0,get:function(){if(f)return i.abortSignalConsumed=!0,f.signal}});var m=function(){return i.options.queryFn?(i.abortSignalConsumed=!1,i.options.queryFn(p)):Promise.reject("Missing queryFn")},v={fetchOptions:n,options:this.options,queryKey:h,state:this.state,fetchFn:m,meta:this.meta};if((a=this.options.behavior)!=null&&a.onFetch){var x;(x=this.options.behavior)==null||x.onFetch(v)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((o=v.fetchOptions)==null?void 0:o.meta)){var w;this.dispatch({type:"fetch",meta:(w=v.fetchOptions)==null?void 0:w.meta})}return this.retryer=new nn({fn:v.fetchFn,abort:f==null||(c=f.abort)==null?void 0:c.bind(f),onSuccess:function(C){i.setData(C),i.cache.config.onSuccess==null||i.cache.config.onSuccess(C,i),i.cacheTime===0&&i.optionalRemove()},onError:function(C){Wt(C)&&C.silent||i.dispatch({type:"error",error:C}),Wt(C)||(i.cache.config.onError==null||i.cache.config.onError(C,i),nr().error(C)),i.cacheTime===0&&i.optionalRemove()},onFail:function(){i.dispatch({type:"failed"})},onPause:function(){i.dispatch({type:"pause"})},onContinue:function(){i.dispatch({type:"continue"})},retry:v.options.retry,retryDelay:v.options.retryDelay}),this.promise=this.retryer.promise,this.promise},e.dispatch=function(r){var n=this;this.state=this.reducer(this.state,r),F.batch(function(){n.observers.forEach(function(i){i.onQueryUpdate(r)}),n.cache.notify({query:n,type:"queryUpdated",action:r})})},e.getDefaultState=function(r){var n=typeof r.initialData=="function"?r.initialData():r.initialData,i=typeof r.initialData<"u",a=i?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0,o=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:o?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:o?"success":"idle"}},e.reducer=function(r,n){var i,a;switch(n.type){case"failed":return R({},r,{fetchFailureCount:r.fetchFailureCount+1});case"pause":return R({},r,{isPaused:!0});case"continue":return R({},r,{isPaused:!1});case"fetch":return R({},r,{fetchFailureCount:0,fetchMeta:(i=n.meta)!=null?i:null,isFetching:!0,isPaused:!1},!r.dataUpdatedAt&&{error:null,status:"loading"});case"success":return R({},r,{data:n.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:(a=n.dataUpdatedAt)!=null?a:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var o=n.error;return Wt(o)&&o.revert&&this.revertState?R({},this.revertState):R({},r,{error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return R({},r,{isInvalidated:!0});case"setState":return R({},r,n.state);default:return r}},s}(),Qi=function(s){Rt(e,s);function e(r){var n;return n=s.call(this)||this,n.config=r||{},n.queries=[],n.queriesMap={},n}var t=e.prototype;return t.build=function(n,i,a){var o,c=i.queryKey,u=(o=i.queryHash)!=null?o:ts(c,i),d=this.get(u);return d||(d=new Zi({cache:this,queryKey:c,queryHash:u,options:n.defaultQueryOptions(i),state:a,defaultOptions:n.getQueryDefaults(c),meta:i.meta}),this.add(d)),d},t.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},t.remove=function(n){var i=this.queriesMap[n.queryHash];i&&(n.destroy(),this.queries=this.queries.filter(function(a){return a!==n}),i===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},t.clear=function(){var n=this;F.batch(function(){n.queries.forEach(function(i){n.remove(i)})})},t.get=function(n){return this.queriesMap[n]},t.getAll=function(){return this.queries},t.find=function(n,i){var a=_e(n,i),o=a[0];return typeof o.exact>"u"&&(o.exact=!0),this.queries.find(function(c){return ds(o,c)})},t.findAll=function(n,i){var a=_e(n,i),o=a[0];return Object.keys(o).length>0?this.queries.filter(function(c){return ds(o,c)}):this.queries},t.notify=function(n){var i=this;F.batch(function(){i.listeners.forEach(function(a){a(n)})})},t.onFocus=function(){var n=this;F.batch(function(){n.queries.forEach(function(i){i.onFocus()})})},t.onOnline=function(){var n=this;F.batch(function(){n.queries.forEach(function(i){i.onOnline()})})},e}($t),zi=function(){function s(t){this.options=R({},t.defaultOptions,t.options),this.mutationId=t.mutationId,this.mutationCache=t.mutationCache,this.observers=[],this.state=t.state||Vi(),this.meta=t.meta}var e=s.prototype;return e.setState=function(r){this.dispatch({type:"setState",state:r})},e.addObserver=function(r){this.observers.indexOf(r)===-1&&this.observers.push(r)},e.removeObserver=function(r){this.observers=this.observers.filter(function(n){return n!==r})},e.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(Q).catch(Q)):Promise.resolve()},e.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},e.execute=function(){var r=this,n,i=this.state.status==="loading",a=Promise.resolve();return i||(this.dispatch({type:"loading",variables:this.options.variables}),a=a.then(function(){r.mutationCache.config.onMutate==null||r.mutationCache.config.onMutate(r.state.variables,r)}).then(function(){return r.options.onMutate==null?void 0:r.options.onMutate(r.state.variables)}).then(function(o){o!==r.state.context&&r.dispatch({type:"loading",context:o,variables:r.state.variables})})),a.then(function(){return r.executeMutation()}).then(function(o){n=o,r.mutationCache.config.onSuccess==null||r.mutationCache.config.onSuccess(n,r.state.variables,r.state.context,r)}).then(function(){return r.options.onSuccess==null?void 0:r.options.onSuccess(n,r.state.variables,r.state.context)}).then(function(){return r.options.onSettled==null?void 0:r.options.onSettled(n,null,r.state.variables,r.state.context)}).then(function(){return r.dispatch({type:"success",data:n}),n}).catch(function(o){return r.mutationCache.config.onError==null||r.mutationCache.config.onError(o,r.state.variables,r.state.context,r),nr().error(o),Promise.resolve().then(function(){return r.options.onError==null?void 0:r.options.onError(o,r.state.variables,r.state.context)}).then(function(){return r.options.onSettled==null?void 0:r.options.onSettled(void 0,o,r.state.variables,r.state.context)}).then(function(){throw r.dispatch({type:"error",error:o}),o})})},e.executeMutation=function(){var r=this,n;return this.retryer=new nn({fn:function(){return r.options.mutationFn?r.options.mutationFn(r.state.variables):Promise.reject("No mutationFn found")},onFail:function(){r.dispatch({type:"failed"})},onPause:function(){r.dispatch({type:"pause"})},onContinue:function(){r.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},e.dispatch=function(r){var n=this;this.state=Ki(this.state,r),F.batch(function(){n.observers.forEach(function(i){i.onMutationUpdate(r)}),n.mutationCache.notify(n)})},s}();function Vi(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Ki(s,e){switch(e.type){case"failed":return R({},s,{failureCount:s.failureCount+1});case"pause":return R({},s,{isPaused:!0});case"continue":return R({},s,{isPaused:!1});case"loading":return R({},s,{context:e.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:e.variables});case"success":return R({},s,{data:e.data,error:null,status:"success",isPaused:!1});case"error":return R({},s,{data:void 0,error:e.error,failureCount:s.failureCount+1,isPaused:!1,status:"error"});case"setState":return R({},s,e.state);default:return s}}var Hi=function(s){Rt(e,s);function e(r){var n;return n=s.call(this)||this,n.config=r||{},n.mutations=[],n.mutationId=0,n}var t=e.prototype;return t.build=function(n,i,a){var o=new zi({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(i),state:a,defaultOptions:i.mutationKey?n.getMutationDefaults(i.mutationKey):void 0,meta:i.meta});return this.add(o),o},t.add=function(n){this.mutations.push(n),this.notify(n)},t.remove=function(n){this.mutations=this.mutations.filter(function(i){return i!==n}),n.cancel(),this.notify(n)},t.clear=function(){var n=this;F.batch(function(){n.mutations.forEach(function(i){n.remove(i)})})},t.getAll=function(){return this.mutations},t.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(i){return hs(n,i)})},t.findAll=function(n){return this.mutations.filter(function(i){return hs(n,i)})},t.notify=function(n){var i=this;F.batch(function(){i.listeners.forEach(function(a){a(n)})})},t.onFocus=function(){this.resumePausedMutations()},t.onOnline=function(){this.resumePausedMutations()},t.resumePausedMutations=function(){var n=this.mutations.filter(function(i){return i.state.isPaused});return F.batch(function(){return n.reduce(function(i,a){return i.then(function(){return a.continue().catch(Q)})},Promise.resolve())})},e}($t);function Wi(){return{onFetch:function(e){e.fetchFn=function(){var t,r,n,i,a,o,c=(t=e.fetchOptions)==null||(r=t.meta)==null?void 0:r.refetchPage,u=(n=e.fetchOptions)==null||(i=n.meta)==null?void 0:i.fetchMore,d=u==null?void 0:u.pageParam,h=(u==null?void 0:u.direction)==="forward",f=(u==null?void 0:u.direction)==="backward",p=((a=e.state.data)==null?void 0:a.pages)||[],m=((o=e.state.data)==null?void 0:o.pageParams)||[],v=rn(),x=v==null?void 0:v.signal,w=m,T=!1,C=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},M=function(ge,Ze,ae,lt){return w=lt?[Ze].concat(w):[].concat(w,[Ze]),lt?[ae].concat(ge):[].concat(ge,[ae])},q=function(ge,Ze,ae,lt){if(T)return Promise.reject("Cancelled");if(typeof ae>"u"&&!Ze&&ge.length)return Promise.resolve(ge);var ve={queryKey:e.queryKey,signal:x,pageParam:ae,meta:e.meta},Ae=C(ve),Mt=Promise.resolve(Ae).then(function(Xn){return M(ge,ae,Xn,lt)});if(sr(Ae)){var Er=Mt;Er.cancel=Ae.cancel}return Mt},U;if(!p.length)U=q([]);else if(h){var pe=typeof d<"u",ot=pe?d:ms(e.options,p);U=q(p,pe,ot)}else if(f){var me=typeof d<"u",ee=me?d:Ji(e.options,p);U=q(p,me,ee,!0)}else(function(){w=[];var Pe=typeof e.options.getNextPageParam>"u",ge=c&&p[0]?c(p[0],0,p):!0;U=ge?q([],Pe,m[0]):Promise.resolve(M([],m[0],p[0]));for(var Ze=function(ve){U=U.then(function(Ae){var Mt=c&&p[ve]?c(p[ve],ve,p):!0;if(Mt){var Er=Pe?m[ve]:ms(e.options,Ae);return q(Ae,Pe,Er)}return Promise.resolve(M(Ae,m[ve],p[ve]))})},ae=1;ae<p.length;ae++)Ze(ae)})();var Ft=U.then(function(Pe){return{pages:Pe,pageParams:w}}),Te=Ft;return Te.cancel=function(){T=!0,v==null||v.abort(),sr(U)&&U.cancel()},Ft}}}}function ms(s,e){return s.getNextPageParam==null?void 0:s.getNextPageParam(e[e.length-1],e)}function Ji(s,e){return s.getPreviousPageParam==null?void 0:s.getPreviousPageParam(e[0],e)}var Gi=function(){function s(t){t===void 0&&(t={}),this.queryCache=t.queryCache||new Qi,this.mutationCache=t.mutationCache||new Hi,this.defaultOptions=t.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var e=s.prototype;return e.mount=function(){var r=this;this.unsubscribeFocus=pt.subscribe(function(){pt.isFocused()&&Ht.isOnline()&&(r.mutationCache.onFocus(),r.queryCache.onFocus())}),this.unsubscribeOnline=Ht.subscribe(function(){pt.isFocused()&&Ht.isOnline()&&(r.mutationCache.onOnline(),r.queryCache.onOnline())})},e.unmount=function(){var r,n;(r=this.unsubscribeFocus)==null||r.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},e.isFetching=function(r,n){var i=_e(r,n),a=i[0];return a.fetching=!0,this.queryCache.findAll(a).length},e.isMutating=function(r){return this.mutationCache.findAll(R({},r,{fetching:!0})).length},e.getQueryData=function(r,n){var i;return(i=this.queryCache.find(r,n))==null?void 0:i.state.data},e.getQueriesData=function(r){return this.getQueryCache().findAll(r).map(function(n){var i=n.queryKey,a=n.state,o=a.data;return[i,o]})},e.setQueryData=function(r,n,i){var a=Kt(r),o=this.defaultQueryOptions(a);return this.queryCache.build(this,o).setData(n,i)},e.setQueriesData=function(r,n,i){var a=this;return F.batch(function(){return a.getQueryCache().findAll(r).map(function(o){var c=o.queryKey;return[c,a.setQueryData(c,n,i)]})})},e.getQueryState=function(r,n){var i;return(i=this.queryCache.find(r,n))==null?void 0:i.state},e.removeQueries=function(r,n){var i=_e(r,n),a=i[0],o=this.queryCache;F.batch(function(){o.findAll(a).forEach(function(c){o.remove(c)})})},e.resetQueries=function(r,n,i){var a=this,o=_e(r,n,i),c=o[0],u=o[1],d=this.queryCache,h=R({},c,{active:!0});return F.batch(function(){return d.findAll(c).forEach(function(f){f.reset()}),a.refetchQueries(h,u)})},e.cancelQueries=function(r,n,i){var a=this,o=_e(r,n,i),c=o[0],u=o[1],d=u===void 0?{}:u;typeof d.revert>"u"&&(d.revert=!0);var h=F.batch(function(){return a.queryCache.findAll(c).map(function(f){return f.cancel(d)})});return Promise.all(h).then(Q).catch(Q)},e.invalidateQueries=function(r,n,i){var a,o,c,u=this,d=_e(r,n,i),h=d[0],f=d[1],p=R({},h,{active:(a=(o=h.refetchActive)!=null?o:h.active)!=null?a:!0,inactive:(c=h.refetchInactive)!=null?c:!1});return F.batch(function(){return u.queryCache.findAll(h).forEach(function(m){m.invalidate()}),u.refetchQueries(p,f)})},e.refetchQueries=function(r,n,i){var a=this,o=_e(r,n,i),c=o[0],u=o[1],d=F.batch(function(){return a.queryCache.findAll(c).map(function(f){return f.fetch(void 0,R({},u,{meta:{refetchPage:c==null?void 0:c.refetchPage}}))})}),h=Promise.all(d).then(Q);return u!=null&&u.throwOnError||(h=h.catch(Q)),h},e.fetchQuery=function(r,n,i){var a=Kt(r,n,i),o=this.defaultQueryOptions(a);typeof o.retry>"u"&&(o.retry=!1);var c=this.queryCache.build(this,o);return c.isStaleByTime(o.staleTime)?c.fetch(o):Promise.resolve(c.state.data)},e.prefetchQuery=function(r,n,i){return this.fetchQuery(r,n,i).then(Q).catch(Q)},e.fetchInfiniteQuery=function(r,n,i){var a=Kt(r,n,i);return a.behavior=Wi(),this.fetchQuery(a)},e.prefetchInfiniteQuery=function(r,n,i){return this.fetchInfiniteQuery(r,n,i).then(Q).catch(Q)},e.cancelMutations=function(){var r=this,n=F.batch(function(){return r.mutationCache.getAll().map(function(i){return i.cancel()})});return Promise.all(n).then(Q).catch(Q)},e.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},e.executeMutation=function(r){return this.mutationCache.build(this,r).execute()},e.getQueryCache=function(){return this.queryCache},e.getMutationCache=function(){return this.mutationCache},e.getDefaultOptions=function(){return this.defaultOptions},e.setDefaultOptions=function(r){this.defaultOptions=r},e.setQueryDefaults=function(r,n){var i=this.queryDefaults.find(function(a){return De(r)===De(a.queryKey)});i?i.defaultOptions=n:this.queryDefaults.push({queryKey:r,defaultOptions:n})},e.getQueryDefaults=function(r){var n;return r?(n=this.queryDefaults.find(function(i){return tr(r,i.queryKey)}))==null?void 0:n.defaultOptions:void 0},e.setMutationDefaults=function(r,n){var i=this.mutationDefaults.find(function(a){return De(r)===De(a.mutationKey)});i?i.defaultOptions=n:this.mutationDefaults.push({mutationKey:r,defaultOptions:n})},e.getMutationDefaults=function(r){var n;return r?(n=this.mutationDefaults.find(function(i){return tr(r,i.mutationKey)}))==null?void 0:n.defaultOptions:void 0},e.defaultQueryOptions=function(r){if(r!=null&&r._defaulted)return r;var n=R({},this.defaultOptions.queries,this.getQueryDefaults(r==null?void 0:r.queryKey),r,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=ts(n.queryKey,n)),n},e.defaultQueryObserverOptions=function(r){return this.defaultQueryOptions(r)},e.defaultMutationOptions=function(r){return r!=null&&r._defaulted?r:R({},this.defaultOptions.mutations,this.getMutationDefaults(r==null?void 0:r.mutationKey),r,{_defaulted:!0})},e.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},s}(),Yi=function(s){Rt(e,s);function e(r,n){var i;return i=s.call(this)||this,i.client=r,i.options=n,i.trackedProps=[],i.selectError=null,i.bindMethods(),i.setOptions(n),i}var t=e.prototype;return t.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},t.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),gs(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},t.onUnsubscribe=function(){this.listeners.length||this.destroy()},t.shouldFetchOnReconnect=function(){return Ur(this.currentQuery,this.options,this.options.refetchOnReconnect)},t.shouldFetchOnWindowFocus=function(){return Ur(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},t.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},t.setOptions=function(n,i){var a=this.options,o=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(n),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=a.queryKey),this.updateQuery();var c=this.hasListeners();c&&vs(this.currentQuery,o,this.options,a)&&this.executeFetch(),this.updateResult(i),c&&(this.currentQuery!==o||this.options.enabled!==a.enabled||this.options.staleTime!==a.staleTime)&&this.updateStaleTimeout();var u=this.computeRefetchInterval();c&&(this.currentQuery!==o||this.options.enabled!==a.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)},t.getOptimisticResult=function(n){var i=this.client.defaultQueryObserverOptions(n),a=this.client.getQueryCache().build(this.client,i);return this.createResult(a,i)},t.getCurrentResult=function(){return this.currentResult},t.trackResult=function(n,i){var a=this,o={},c=function(d){a.trackedProps.includes(d)||a.trackedProps.push(d)};return Object.keys(n).forEach(function(u){Object.defineProperty(o,u,{configurable:!1,enumerable:!0,get:function(){return c(u),n[u]}})}),(i.useErrorBoundary||i.suspense)&&c("error"),o},t.getNextResult=function(n){var i=this;return new Promise(function(a,o){var c=i.subscribe(function(u){u.isFetching||(c(),u.isError&&(n!=null&&n.throwOnError)?o(u.error):a(u))})})},t.getCurrentQuery=function(){return this.currentQuery},t.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},t.refetch=function(n){return this.fetch(R({},n,{meta:{refetchPage:n==null?void 0:n.refetchPage}}))},t.fetchOptimistic=function(n){var i=this,a=this.client.defaultQueryObserverOptions(n),o=this.client.getQueryCache().build(this.client,a);return o.fetch().then(function(){return i.createResult(o,a)})},t.fetch=function(n){var i=this;return this.executeFetch(n).then(function(){return i.updateResult(),i.currentResult})},t.executeFetch=function(n){this.updateQuery();var i=this.currentQuery.fetch(this.options,n);return n!=null&&n.throwOnError||(i=i.catch(Q)),i},t.updateStaleTimeout=function(){var n=this;if(this.clearStaleTimeout(),!(Xt||this.currentResult.isStale||!Dr(this.options.staleTime))){var i=en(this.currentResult.dataUpdatedAt,this.options.staleTime),a=i+1;this.staleTimeoutId=setTimeout(function(){n.currentResult.isStale||n.updateResult()},a)}},t.computeRefetchInterval=function(){var n;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(n=this.options.refetchInterval)!=null?n:!1},t.updateRefetchInterval=function(n){var i=this;this.clearRefetchInterval(),this.currentRefetchInterval=n,!(Xt||this.options.enabled===!1||!Dr(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(i.options.refetchIntervalInBackground||pt.isFocused())&&i.executeFetch()},this.currentRefetchInterval))},t.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},t.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},t.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},t.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},t.createResult=function(n,i){var a=this.currentQuery,o=this.options,c=this.currentResult,u=this.currentResultState,d=this.currentResultOptions,h=n!==a,f=h?n.state:this.currentQueryInitialState,p=h?this.currentResult:this.previousQueryResult,m=n.state,v=m.dataUpdatedAt,x=m.error,w=m.errorUpdatedAt,T=m.isFetching,C=m.status,M=!1,q=!1,U;if(i.optimisticResults){var pe=this.hasListeners(),ot=!pe&&gs(n,i),me=pe&&vs(n,a,i,o);(ot||me)&&(T=!0,v||(C="loading"))}if(i.keepPreviousData&&!m.dataUpdateCount&&(p!=null&&p.isSuccess)&&C!=="error")U=p.data,v=p.dataUpdatedAt,C=p.status,M=!0;else if(i.select&&typeof m.data<"u")if(c&&m.data===(u==null?void 0:u.data)&&i.select===this.selectFn)U=this.selectResult;else try{this.selectFn=i.select,U=i.select(m.data),i.structuralSharing!==!1&&(U=rr(c==null?void 0:c.data,U)),this.selectResult=U,this.selectError=null}catch(Te){nr().error(Te),this.selectError=Te}else U=m.data;if(typeof i.placeholderData<"u"&&typeof U>"u"&&(C==="loading"||C==="idle")){var ee;if(c!=null&&c.isPlaceholderData&&i.placeholderData===(d==null?void 0:d.placeholderData))ee=c.data;else if(ee=typeof i.placeholderData=="function"?i.placeholderData():i.placeholderData,i.select&&typeof ee<"u")try{ee=i.select(ee),i.structuralSharing!==!1&&(ee=rr(c==null?void 0:c.data,ee)),this.selectError=null}catch(Te){nr().error(Te),this.selectError=Te}typeof ee<"u"&&(C="success",U=ee,q=!0)}this.selectError&&(x=this.selectError,U=this.selectResult,w=Date.now(),C="error");var Ft={status:C,isLoading:C==="loading",isSuccess:C==="success",isError:C==="error",isIdle:C==="idle",data:U,dataUpdatedAt:v,error:x,errorUpdatedAt:w,failureCount:m.fetchFailureCount,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>f.dataUpdateCount||m.errorUpdateCount>f.errorUpdateCount,isFetching:T,isRefetching:T&&C!=="loading",isLoadingError:C==="error"&&m.dataUpdatedAt===0,isPlaceholderData:q,isPreviousData:M,isRefetchError:C==="error"&&m.dataUpdatedAt!==0,isStale:rs(n,i),refetch:this.refetch,remove:this.remove};return Ft},t.shouldNotifyListeners=function(n,i){if(!i)return!0;var a=this.options,o=a.notifyOnChangeProps,c=a.notifyOnChangePropsExclusions;if(!o&&!c||o==="tracked"&&!this.trackedProps.length)return!0;var u=o==="tracked"?this.trackedProps:o;return Object.keys(n).some(function(d){var h=d,f=n[h]!==i[h],p=u==null?void 0:u.some(function(v){return v===d}),m=c==null?void 0:c.some(function(v){return v===d});return f&&!m&&(!u||p)})},t.updateResult=function(n){var i=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!Di(this.currentResult,i)){var a={cache:!0};(n==null?void 0:n.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,i)&&(a.listeners=!0),this.notify(R({},a,n))}},t.updateQuery=function(){var n=this.client.getQueryCache().build(this.client,this.options);if(n!==this.currentQuery){var i=this.currentQuery;this.currentQuery=n,this.currentQueryInitialState=n.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(i==null||i.removeObserver(this),n.addObserver(this))}},t.onQueryUpdate=function(n){var i={};n.type==="success"?i.onSuccess=!0:n.type==="error"&&!Wt(n.error)&&(i.onError=!0),this.updateResult(i),this.hasListeners()&&this.updateTimers()},t.notify=function(n){var i=this;F.batch(function(){n.onSuccess?(i.options.onSuccess==null||i.options.onSuccess(i.currentResult.data),i.options.onSettled==null||i.options.onSettled(i.currentResult.data,null)):n.onError&&(i.options.onError==null||i.options.onError(i.currentResult.error),i.options.onSettled==null||i.options.onSettled(void 0,i.currentResult.error)),n.listeners&&i.listeners.forEach(function(a){a(i.currentResult)}),n.cache&&i.client.getQueryCache().notify({query:i.currentQuery,type:"observerResultsUpdated"})})},e}($t);function Xi(s,e){return e.enabled!==!1&&!s.state.dataUpdatedAt&&!(s.state.status==="error"&&e.retryOnMount===!1)}function gs(s,e){return Xi(s,e)||s.state.dataUpdatedAt>0&&Ur(s,e,e.refetchOnMount)}function Ur(s,e,t){if(e.enabled!==!1){var r=typeof t=="function"?t(s):t;return r==="always"||r!==!1&&rs(s,e)}return!1}function vs(s,e,t,r){return t.enabled!==!1&&(s!==e||r.enabled===!1)&&(!t.suspense||s.state.status!=="error")&&rs(s,t)}function rs(s,e){return s.isStaleByTime(e.staleTime)}var ea=ti.unstable_batchedUpdates;F.setBatchNotifyFunction(ea);var ta=console;Bi(ta);var ys=W.createContext(void 0),on=W.createContext(!1);function ln(s){return s&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=ys),window.ReactQueryClientContext):ys}var cn=function(){var e=W.useContext(ln(W.useContext(on)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},ra=function(e){var t=e.client,r=e.contextSharing,n=r===void 0?!1:r,i=e.children;W.useEffect(function(){return t.mount(),function(){t.unmount()}},[t]);var a=ln(n);return W.createElement(on.Provider,{value:n},W.createElement(a.Provider,{value:t},i))};function sa(){var s=!1;return{clearReset:function(){s=!1},reset:function(){s=!0},isReset:function(){return s}}}var na=W.createContext(sa()),ia=function(){return W.useContext(na)};function aa(s,e,t){return typeof e=="function"?e.apply(void 0,t):typeof e=="boolean"?e:!!s}function oa(s,e){var t=W.useRef(!1),r=W.useState(0),n=r[1],i=cn(),a=ia(),o=i.defaultQueryObserverOptions(s);o.optimisticResults=!0,o.onError&&(o.onError=F.batchCalls(o.onError)),o.onSuccess&&(o.onSuccess=F.batchCalls(o.onSuccess)),o.onSettled&&(o.onSettled=F.batchCalls(o.onSettled)),o.suspense&&(typeof o.staleTime!="number"&&(o.staleTime=1e3),o.cacheTime===0&&(o.cacheTime=1)),(o.suspense||o.useErrorBoundary)&&(a.isReset()||(o.retryOnMount=!1));var c=W.useState(function(){return new e(i,o)}),u=c[0],d=u.getOptimisticResult(o);if(W.useEffect(function(){t.current=!0,a.clearReset();var h=u.subscribe(F.batchCalls(function(){t.current&&n(function(f){return f+1})}));return u.updateResult(),function(){t.current=!1,h()}},[a,u]),W.useEffect(function(){u.setOptions(o,{listeners:!1})},[o,u]),o.suspense&&d.isLoading)throw u.fetchOptimistic(o).then(function(h){var f=h.data;o.onSuccess==null||o.onSuccess(f),o.onSettled==null||o.onSettled(f,null)}).catch(function(h){a.clearReset(),o.onError==null||o.onError(h),o.onSettled==null||o.onSettled(void 0,h)});if(d.isError&&!a.isReset()&&!d.isFetching&&aa(o.suspense,o.useErrorBoundary,[d.error,u.getCurrentQuery()]))throw d.error;return o.notifyOnChangeProps==="tracked"&&(d=u.trackResult(d,o)),d}function vr(s,e,t){var r=Kt(s,e,t);return oa(r,Yi)}let la={data:""},ca=s=>typeof window=="object"?((s?s.querySelector("#_goober"):window._goober)||Object.assign((s||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:s||la,ua=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,da=/\/\*[^]*?\*\/|  +/g,bs=/\n+/g,we=(s,e)=>{let t="",r="",n="";for(let i in s){let a=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+a+";":r+=i[1]=="f"?we(a,i):i+"{"+we(a,i[1]=="k"?"":e)+"}":typeof a=="object"?r+=we(a,e?e.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=we.p?we.p(i,a):i+":"+a+";")}return t+(e&&n?e+"{"+n+"}":n)+r},ue={},un=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+un(s[t]);return e}return s},ha=(s,e,t,r,n)=>{let i=un(s),a=ue[i]||(ue[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!ue[a]){let c=i!==s?s:(u=>{let d,h,f=[{}];for(;d=ua.exec(u.replace(da,""));)d[4]?f.shift():d[3]?(h=d[3].replace(bs," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][d[1]]=d[2].replace(bs," ").trim();return f[0]})(s);ue[a]=we(n?{["@keyframes "+a]:c}:c,t?"":"."+a)}let o=t&&ue.g?ue.g:null;return t&&(ue.g=ue[a]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(ue[a],e,r,o),a},fa=(s,e,t)=>s.reduce((r,n,i)=>{let a=e[i];if(a&&a.call){let o=a(t),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=c?"."+c:o&&typeof o=="object"?o.props?"":we(o,""):o===!1?"":o}return r+n+(a??"")},"");function yr(s){let e=this||{},t=s.call?s(e.p):s;return ha(t.unshift?t.raw?fa(t,[].slice.call(arguments,1),e.p):t.reduce((r,n)=>Object.assign(r,n&&n.call?n(e.p):n),{}):t,ca(e.target),e.g,e.o,e.k)}let dn,Fr,Mr;yr.bind({g:1});let he=yr.bind({k:1});function pa(s,e,t,r){we.p=e,dn=s,Fr=t,Mr=r}function Oe(s,e){let t=this||{};return function(){let r=arguments;function n(i,a){let o=Object.assign({},i),c=o.className||n.className;t.p=Object.assign({theme:Fr&&Fr()},o),t.o=/ *go\d+/.test(c),o.className=yr.apply(t,r)+(c?" "+c:"");let u=s;return s[0]&&(u=o.as||s,delete o.as),Mr&&u[0]&&Mr(o),dn(u,o)}return n}}var ma=s=>typeof s=="function",ir=(s,e)=>ma(s)?s(e):s,ga=(()=>{let s=0;return()=>(++s).toString()})(),hn=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),va=20,Jt=new Map,ya=1e3,_s=s=>{if(Jt.has(s))return;let e=setTimeout(()=>{Jt.delete(s),Me({type:4,toastId:s})},ya);Jt.set(s,e)},ba=s=>{let e=Jt.get(s);e&&clearTimeout(e)},qr=(s,e)=>{switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,va)};case 1:return e.toast.id&&ba(e.toast.id),{...s,toasts:s.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:t}=e;return s.toasts.find(i=>i.id===t.id)?qr(s,{type:1,toast:t}):qr(s,{type:0,toast:t});case 3:let{toastId:r}=e;return r?_s(r):s.toasts.forEach(i=>{_s(i.id)}),{...s,toasts:s.toasts.map(i=>i.id===r||r===void 0?{...i,visible:!1}:i)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let n=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+n}))}}},Gt=[],Yt={toasts:[],pausedAt:void 0},Me=s=>{Yt=qr(Yt,s),Gt.forEach(e=>{e(Yt)})},_a={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},xa=(s={})=>{let[e,t]=_.useState(Yt);_.useEffect(()=>(Gt.push(t),()=>{let n=Gt.indexOf(t);n>-1&&Gt.splice(n,1)}),[e]);let r=e.toasts.map(n=>{var i,a;return{...s,...s[n.type],...n,duration:n.duration||((i=s[n.type])==null?void 0:i.duration)||(s==null?void 0:s.duration)||_a[n.type],style:{...s.style,...(a=s[n.type])==null?void 0:a.style,...n.style}}});return{...e,toasts:r}},wa=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||ga()}),It=s=>(e,t)=>{let r=wa(e,s,t);return Me({type:2,toast:r}),r.id},B=(s,e)=>It("blank")(s,e);B.error=It("error");B.success=It("success");B.loading=It("loading");B.custom=It("custom");B.dismiss=s=>{Me({type:3,toastId:s})};B.remove=s=>Me({type:4,toastId:s});B.promise=(s,e,t)=>{let r=B.loading(e.loading,{...t,...t==null?void 0:t.loading});return s.then(n=>(B.success(ir(e.success,n),{id:r,...t,...t==null?void 0:t.success}),n)).catch(n=>{B.error(ir(e.error,n),{id:r,...t,...t==null?void 0:t.error})}),s};var ja=(s,e)=>{Me({type:1,toast:{id:s,height:e}})},ka=()=>{Me({type:5,time:Date.now()})},Sa=s=>{let{toasts:e,pausedAt:t}=xa(s);_.useEffect(()=>{if(t)return;let i=Date.now(),a=e.map(o=>{if(o.duration===1/0)return;let c=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(c<0){o.visible&&B.dismiss(o.id);return}return setTimeout(()=>B.dismiss(o.id),c)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[e,t]);let r=_.useCallback(()=>{t&&Me({type:6,time:Date.now()})},[t]),n=_.useCallback((i,a)=>{let{reverseOrder:o=!1,gutter:c=8,defaultPosition:u}=a||{},d=e.filter(p=>(p.position||u)===(i.position||u)&&p.height),h=d.findIndex(p=>p.id===i.id),f=d.filter((p,m)=>m<h&&p.visible).length;return d.filter(p=>p.visible).slice(...o?[f+1]:[0,f]).reduce((p,m)=>p+(m.height||0)+c,0)},[e]);return{toasts:e,handlers:{updateHeight:ja,startPause:ka,endPause:r,calculateOffset:n}}},Na=he`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Ca=he`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ea=he`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Oa=Oe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Na} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Ca} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ea} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Ta=he`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Pa=Oe("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${Ta} 1s linear infinite;
`,Aa=he`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ra=he`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,$a=Oe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Aa} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ra} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Ia=Oe("div")`
  position: absolute;
`,Da=Oe("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,La=he`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ua=Oe("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${La} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Fa=({toast:s})=>{let{icon:e,type:t,iconTheme:r}=s;return e!==void 0?typeof e=="string"?_.createElement(Ua,null,e):e:t==="blank"?null:_.createElement(Da,null,_.createElement(Pa,{...r}),t!=="loading"&&_.createElement(Ia,null,t==="error"?_.createElement(Oa,{...r}):_.createElement($a,{...r})))},Ma=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,qa=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Ba="0%{opacity:0;} 100%{opacity:1;}",Za="0%{opacity:1;} 100%{opacity:0;}",Qa=Oe("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,za=Oe("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Va=(s,e)=>{let t=s.includes("top")?1:-1,[r,n]=hn()?[Ba,Za]:[Ma(t),qa(t)];return{animation:e?`${he(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${he(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Ka=_.memo(({toast:s,position:e,style:t,children:r})=>{let n=s.height?Va(s.position||e||"top-center",s.visible):{opacity:0},i=_.createElement(Fa,{toast:s}),a=_.createElement(za,{...s.ariaProps},ir(s.message,s));return _.createElement(Qa,{className:s.className,style:{...n,...t,...s.style}},typeof r=="function"?r({icon:i,message:a}):_.createElement(_.Fragment,null,i,a))});pa(_.createElement);var Ha=({id:s,className:e,style:t,onHeightUpdate:r,children:n})=>{let i=_.useCallback(a=>{if(a){let o=()=>{let c=a.getBoundingClientRect().height;r(s,c)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[s,r]);return _.createElement("div",{ref:i,className:e,style:t},n)},Wa=(s,e)=>{let t=s.includes("top"),r=t?{top:0}:{bottom:0},n=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...n}},Ja=yr`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,qt=16,fn=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:r,children:n,containerStyle:i,containerClassName:a})=>{let{toasts:o,handlers:c}=Sa(t);return _.createElement("div",{style:{position:"fixed",zIndex:9999,top:qt,left:qt,right:qt,bottom:qt,pointerEvents:"none",...i},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(u=>{let d=u.position||e,h=c.calculateOffset(u,{reverseOrder:s,gutter:r,defaultPosition:e}),f=Wa(d,h);return _.createElement(Ha,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?Ja:"",style:f},u.type==="custom"?ir(u.message,u):n?n(u):_.createElement(Ka,{toast:u,position:d}))}))},Ga=B;const Ya="modulepreload",Xa=function(s){return"/"+s},xs={},Xe=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=Xa(c),c in xs)return;xs[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Ya,u||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},eo=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Xe(async()=>{const{default:r}=await Promise.resolve().then(()=>it);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class ss extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class to extends ss{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ro extends ss{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class so extends ss{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Br;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Br||(Br={}));var no=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};class io{constructor(e,{headers:t={},customFetch:r,region:n=Br.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=eo(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return no(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:c}=t;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let u;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const d=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(m=>{throw new to(m)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new ro(d);if(!d.ok)throw new so(d);let f=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(n){return{data:null,error:n}}})}}var H={},ns={},br={},Dt={},_r={},xr={},ao=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},et=ao();const oo=et.fetch,pn=et.fetch.bind(et),mn=et.Headers,lo=et.Request,co=et.Response,it=Object.freeze(Object.defineProperty({__proto__:null,Headers:mn,Request:lo,Response:co,default:pn,fetch:oo},Symbol.toStringTag,{value:"Module"})),uo=ri(it);var wr={};Object.defineProperty(wr,"__esModule",{value:!0});class ho extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}wr.default=ho;var gn=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(xr,"__esModule",{value:!0});const fo=gn(uo),po=gn(wr);let mo=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fo.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,c;let u=null,d=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=await i.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=w:d=JSON.parse(w))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),x=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");v&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const v=await i.text();try{u=JSON.parse(v),Array.isArray(u)&&i.status===404&&(d=[],u=null,f=200,p="OK")}catch{i.status===404&&v===""?(f=204,p="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,p="OK"),u&&this.shouldThrowOnError)throw new po.default(u)}return{error:u,data:d,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var a,o,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}};xr.default=mo;var go=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(_r,"__esModule",{value:!0});const vo=go(xr);let yo=class extends vo.default{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};_r.default=yo;var bo=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Dt,"__esModule",{value:!0});const _o=bo(_r);let xo=class extends _o.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Dt.default=xo;var wo=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(br,"__esModule",{value:!0});const ct=wo(Dt);let jo=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new ct.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new ct.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ct.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new ct.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ct.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};br.default=jo;var jr={},kr={};Object.defineProperty(kr,"__esModule",{value:!0});kr.version=void 0;kr.version="0.0.0-automated";Object.defineProperty(jr,"__esModule",{value:!0});jr.DEFAULT_HEADERS=void 0;const ko=kr;jr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ko.version}`};var vn=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ns,"__esModule",{value:!0});const So=vn(br),No=vn(Dt),Co=jr;let Eo=class yn{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Co.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new So.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new yn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let c;r||n?(a=r?"HEAD":"GET",Object.entries(t).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(a="POST",c=t);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new No.default({method:a,url:o,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};ns.default=Eo;var at=X&&X.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(H,"__esModule",{value:!0});H.PostgrestError=H.PostgrestBuilder=H.PostgrestTransformBuilder=H.PostgrestFilterBuilder=H.PostgrestQueryBuilder=H.PostgrestClient=void 0;const bn=at(ns);H.PostgrestClient=bn.default;const _n=at(br);H.PostgrestQueryBuilder=_n.default;const xn=at(Dt);H.PostgrestFilterBuilder=xn.default;const wn=at(_r);H.PostgrestTransformBuilder=wn.default;const jn=at(xr);H.PostgrestBuilder=jn.default;const kn=at(wr);H.PostgrestError=kn.default;var Oo=H.default={PostgrestClient:bn.default,PostgrestQueryBuilder:_n.default,PostgrestFilterBuilder:xn.default,PostgrestTransformBuilder:wn.default,PostgrestBuilder:jn.default,PostgrestError:kn.default};const{PostgrestClient:To,PostgrestQueryBuilder:pd,PostgrestFilterBuilder:md,PostgrestTransformBuilder:gd,PostgrestBuilder:vd}=Oo,Po="2.10.9",Ao={"X-Client-Info":`realtime-js/${Po}`},Ro="1.0.0",Sn=1e4,$o=1e3;var Ge;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Ge||(Ge={}));var J;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(J||(J={}));var re;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(re||(re={}));var Zr;(function(s){s.websocket="websocket"})(Zr||(Zr={}));var Ie;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Ie||(Ie={}));class Io{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+n));a=a+n;const c=r.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class Nn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var I;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(I||(I={}));const ws=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=Do(a,s,e,n),i),{})},Do=(s,e,t,r)=>{const n=e.find(o=>o.name===s),i=n==null?void 0:n.type,a=t[s];return i&&!r.includes(i)?Cn(i,a):Qr(a)},Cn=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return Mo(e,t)}switch(s){case I.bool:return Lo(e);case I.float4:case I.float8:case I.int2:case I.int4:case I.int8:case I.numeric:case I.oid:return Uo(e);case I.json:case I.jsonb:return Fo(e);case I.timestamp:return qo(e);case I.abstime:case I.date:case I.daterange:case I.int4range:case I.int8range:case I.money:case I.reltime:case I.text:case I.time:case I.timestamptz:case I.timetz:case I.tsrange:case I.tstzrange:return Qr(e);default:return Qr(e)}},Qr=s=>s,Lo=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Uo=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Fo=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},Mo=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const a=s.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Cn(e,o))}return s},qo=s=>typeof s=="string"?s.replace(" ","T"):s,En=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Or{constructor(e,t,r={},n=Sn){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var js;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(js||(js={}));class mt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mt.syncState(this.state,n,i,a),this.pendingDiffs.forEach(c=>{this.state=mt.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=mt.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const f=d.map(x=>x.presence_ref),p=h.map(x=>x.presence_ref),m=d.filter(x=>p.indexOf(x.presence_ref)<0),v=h.filter(x=>f.indexOf(x.presence_ref)<0);m.length>0&&(o[u]=m),v.length>0&&(c[u]=v)}else o[u]=d}),this.syncDiff(i,{joins:o,leaves:c},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(o,c)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(c),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}r(o,d,c)}),this.map(a,(o,c)=>{let u=e[o];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,n(o,u,c),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ks;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ks||(ks={}));var Ss;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Ss||(Ss={}));var Ns;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Ns||(Ns={}));class is{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Or(this,re.join,this.params,this.timeout),this.rejoinTimer=new Nn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(re.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new mt(this),this.broadcastEndpointURL=En(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(d=>e&&e("CHANNEL_ERROR",d)),this._onClose(()=>e&&e("CLOSED"));const c={},u={broadcast:i,presence:a,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessToken&&(c.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:d})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),d===void 0){e&&e("SUBSCRIBED");return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,m=[];for(let v=0;v<p;v++){const x=f[v],{filter:{event:w,schema:T,table:C,filter:M}}=x,q=d&&d[v];if(q&&q.event===w&&q.schema===T&&q.table===C&&q.filter===M)m.push(Object.assign(Object.assign({},x),{id:q.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e("SUBSCRIBED");return}}).receive("error",d=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=J.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(re.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const n=new Or(this,re.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Or(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=re;if(r&&[o,c,u,d].indexOf(a)>=0&&r!==this._joinRef())return;let f=this._onMessage(a,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var m,v,x;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((x=(v=p.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(f,r)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var m,v,x,w,T,C;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const M=p.id,q=(m=p.filter)===null||m===void 0?void 0:m.event;return M&&((v=t.ids)===null||v===void 0?void 0:v.includes(M))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const M=(T=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return M==="*"||M===((C=t==null?void 0:t.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:v,table:x,commit_timestamp:w,type:T,errors:C}=m;f=Object.assign(Object.assign({},{schema:v,table:x,commit_timestamp:w,eventType:T,new:{},old:{},errors:C}),this._getPayloadRecords(m))}p.callback(f,r)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&is.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(re.close,{},e)}_onError(e){this._on(re.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ws(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ws(e.columns,e.old_record)),t}}const Bo=()=>{},Zo=typeof WebSocket<"u",Qo=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zo{constructor(e,t){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Ao,this.params={},this.timeout=Sn,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Bo,this.conn=null,this.sendBuffer=[],this.serializer=new Io,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Xe(async()=>{const{default:c}=await Promise.resolve().then(()=>it);return{default:c}},void 0).then(({default:c})=>c(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Zr.websocket}`,this.httpEndpoint=En(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Nn(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Zo){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Vo(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Xe(async()=>{const{default:e}=await import("./browser-Dsv42Fo6.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ge.connecting:return Ie.Connecting;case Ge.open:return Ie.Open;case Ge.closing:return Ie.Closing;default:return Ie.Closed}}isConnected(){return this.connectionState()===Ie.Open}channel(e,t={config:{}}){const r=new is(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){if(e){let t=null;try{t=JSON.parse(atob(e.split(".")[1]))}catch{}if(t&&t.exp&&!(Math.floor(Date.now()/1e3)-t.exp<0)){this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`);return}}this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(re.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ro}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:n,payload:i,ref:a}=t;(a&&a===this.pendingHeartbeatRef||n===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${n} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(n,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(re.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close($o,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Qo],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Vo{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ge.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class as extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Z(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Ko extends as{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class zr extends as{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ho=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};const On=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Xe(async()=>{const{default:r}=await Promise.resolve().then(()=>it);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Wo=()=>Ho(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Xe(()=>Promise.resolve().then(()=>it),void 0)).Response:Response}),Vr=s=>{if(Array.isArray(s))return s.map(t=>Vr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Vr(r)}),e};var qe=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};const Tr=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Jo=(s,e,t)=>qe(void 0,void 0,void 0,function*(){const r=yield Wo();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{e(new Ko(Tr(n),s.status||500))}).catch(n=>{e(new zr(Tr(n),n))}):e(new zr(Tr(s),s))}),Go=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),t))};function Lt(s,e,t,r,n,i){return qe(this,void 0,void 0,function*(){return new Promise((a,o)=>{s(t,Go(e,r,n,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Jo(c,o,r))})})}function ar(s,e,t,r){return qe(this,void 0,void 0,function*(){return Lt(s,"GET",e,t,r)})}function xe(s,e,t,r,n){return qe(this,void 0,void 0,function*(){return Lt(s,"POST",e,r,n,t)})}function Yo(s,e,t,r,n){return qe(this,void 0,void 0,function*(){return Lt(s,"PUT",e,r,n,t)})}function Xo(s,e,t,r){return qe(this,void 0,void 0,function*(){return Lt(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Tn(s,e,t,r,n){return qe(this,void 0,void 0,function*(){return Lt(s,"DELETE",e,r,n,t)})}var K=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};const el={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class tl{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=On(n)}uploadOrUpdate(e,t,r,n){return K(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Cs),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Z(i))return{data:null,error:i};throw i}})}upload(e,t,r){return K(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return K(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let c;const u=Object.assign({upsert:Cs.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(c){if(Z(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return K(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield xe(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new as("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}})}update(e,t,r){return K(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return K(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}copy(e,t,r){return K(this,void 0,void 0,function*(){try{return{data:{path:(yield xe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return K(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield xe(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return K(this,void 0,void 0,function*(){try{const n=yield xe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}download(e,t){return K(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield ar(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Z(o))return{data:null,error:o};throw o}})}info(e){return K(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ar(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Vr(r),error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}})}exists(e){return K(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Xo(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Z(r)&&r instanceof zr){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return K(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}list(e,t,r){return K(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},el),t),{prefix:e||""});return{data:yield xe(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const rl="2.7.1",sl={"X-Client-Info":`storage-js/${rl}`};var Qe=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};class nl{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},sl),t),this.fetch=On(r)}listBuckets(){return Qe(this,void 0,void 0,function*(){try{return{data:yield ar(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Z(e))return{data:null,error:e};throw e}})}getBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield ar(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Qe(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Qe(this,void 0,void 0,function*(){try{return{data:yield Yo(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}}class il extends nl{constructor(e,t={},r){super(e,t,r)}from(e){return new tl(this.url,this.headers,e,this.fetch)}}const al="2.46.2";let dt="";typeof Deno<"u"?dt="deno":typeof document<"u"?dt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?dt="react-native":dt="node";const ol={"X-Client-Info":`supabase-js-${dt}/${al}`},ll={headers:ol},cl={schema:"public"},ul={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dl={};var hl=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};const fl=s=>{let e;return s?e=s:typeof fetch>"u"?e=pn:e=fetch,(...t)=>e(...t)},pl=()=>typeof Headers>"u"?mn:Headers,ml=(s,e,t)=>{const r=fl(t),n=pl();return(i,a)=>hl(void 0,void 0,void 0,function*(){var o;const c=(o=yield e())!==null&&o!==void 0?o:s;let u=new n(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",s),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},a),{headers:u}))})};var gl=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};function vl(s){return s.replace(/\/$/,"")}function yl(s,e){const{db:t,auth:r,realtime:n,global:i}=s,{db:a,auth:o,realtime:c,global:u}=e,d={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},c),n),global:Object.assign(Object.assign({},u),i),accessToken:()=>gl(this,void 0,void 0,function*(){return""})};return s.accessToken?d.accessToken=s.accessToken:delete d.accessToken,d}const Pn="2.65.1",bl="http://localhost:9999",_l="supabase.auth.token",xl={"X-Client-Info":`gotrue-js/${Pn}`},Es=10,Kr="X-Supabase-Api-Version",An={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function wl(s){return Math.round(Date.now()/1e3)+s}function jl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const te=()=>typeof document<"u",Re={tested:!1,writable:!1},gt=()=>{if(!te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Re.tested)return Re.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Re.tested=!0,Re.writable=!0}catch{Re.tested=!0,Re.writable=!1}return Re.writable};function Pr(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const Rn=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Xe(async()=>{const{default:r}=await Promise.resolve().then(()=>it);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},kl=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",$n=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Bt=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Zt=async(s,e)=>{await s.removeItem(e)};function Sl(s){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,n,i,a,o,c,u,d=0;for(s=s.replace("-","+").replace("_","/");d<s.length;)a=e.indexOf(s.charAt(d++)),o=e.indexOf(s.charAt(d++)),c=e.indexOf(s.charAt(d++)),u=e.indexOf(s.charAt(d++)),r=a<<2|o>>4,n=(o&15)<<4|c>>2,i=(c&3)<<6|u,t=t+String.fromCharCode(r),c!=64&&n!=0&&(t=t+String.fromCharCode(n)),u!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Sr{constructor(){this.promise=new Sr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Sr.promiseConstructor=Promise;function Os(s){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=s.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(Sl(r))}async function Nl(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function Cl(s,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await s(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function El(s){return("0"+s.toString(16)).substr(-2)}function Ol(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,El).join("")}async function Tl(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function Pl(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Tl(s);return Pl(t)}async function ze(s,e,t=!1){const r=Ol();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await $n(s,`${e}-code-verifier`,n);const i=await Al(r);return[i,r===i?"plain":"s256"]}const Rl=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $l(s){const e=s.headers.get(Kr);if(!e||!e.match(Rl))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class os extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function O(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class Il extends os{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Dl(s){return O(s)&&s.name==="AuthApiError"}class In extends os{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Be extends os{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class ye extends Be{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ll(s){return O(s)&&s.name==="AuthSessionMissingError"}class Ar extends Be{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qt extends Be{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class zt extends Be{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ts extends Be{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hr extends Be{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Rr(s){return O(s)&&s.name==="AuthRetryableFetchError"}class Ps extends Be{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var Ul=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const $e=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Fl=[502,503,504];async function As(s){var e;if(!kl(s))throw new Hr($e(s),0);if(Fl.includes(s.status))throw new Hr($e(s),s.status);let t;try{t=await s.json()}catch(i){throw new In($e(i),i)}let r;const n=$l(s);if(n&&n.getTime()>=An["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Ps($e(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ye}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Ps($e(t),s.status,t.weak_password.reasons);throw new Il($e(t),s.status||500,r)}const Ml=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function P(s,e,t,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[Kr]||(i[Kr]=An["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await ql(s,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function ql(s,e,t,r,n,i){const a=Ml(e,r,n,i);let o;try{o=await s(t,Object.assign({},a))}catch(c){throw console.error(c),new Hr($e(c),0)}if(o.ok||await As(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(c){await As(c)}}function be(s){var e;let t=null;zl(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=wl(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function Rs(s){const e=be(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function je(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Bl(s){return{data:s,error:null}}function Zl(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i}=s,a=Ul(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},a);return{data:{properties:o,user:c},error:null}}function Ql(s){return s}function zl(s){return s.access_token&&s.refresh_token&&s.expires_in}var Vl=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class Kl{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Rn(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await P(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await P(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:je})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Vl(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await P(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Zl,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(O(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await P(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:je})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,i,a,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await P(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Ql});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(m.split(";")[1].split("=")[1]);u[`${x}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(O(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await P(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:je})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await P(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:je})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await P(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:je})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await P(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(O(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await P(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}}}const Hl={getItem:s=>gt()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{gt()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{gt()&&globalThis.localStorage.removeItem(s)}};function $s(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function Wl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ve={debug:!!(globalThis&&gt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Dn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Jl extends Dn{}async function Gl(s,e,t){Ve.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Ve.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){Ve.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{Ve.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw Ve.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Jl(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Ve.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}Wl();const Yl={url:bl,storageKey:_l,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xl,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},ut=30*1e3,Is=3;async function Ds(s,e,t){return await t()}class yt{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=yt.nextInstanceID,yt.nextInstanceID+=1,this.instanceID>0&&te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Yl),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Kl({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Rn(n.fetch),this.lock=n.lock||Ds,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:te()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Gl:this.lock=Ds,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:gt()?this.storage=Hl:(this.memoryStorage={},this.storage=$s(this.memoryStorage)):(this.memoryStorage={},this.storage=$s(this.memoryStorage)),te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=te()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.code)==="identity_already_exists"?{error:r}:(await this._removeSession(),{error:r});const{session:n,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return O(e)?{error:e}:{error:new In("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:be}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(O(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await ze(this.storage,this.storageKey)),i=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:be})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:be})}else throw new Qt("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(O(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Rs})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Rs})}else throw new Qt("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ar}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Bt(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:i,error:a}=await P(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:be});if(await Zt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ar}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(O(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:a}=e,o=await P(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:be}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ar}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,i,a;try{if("email"in e){const{email:o,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ze(this.storage,this.storageKey));const{error:h}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:c}=e,{data:u,error:d}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Qt("You must provide either an email or phone number.")}catch(o){if(O(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await P(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:be});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(O(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await ze(this.storage,this.storageKey)),await P(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Bl})}catch(i){if(O(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ye;const{error:n}=await P(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:a}=await P(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:a,error:o}=await P(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Qt("You must provide either an email or phone number and a type")}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Bt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:je}):await this._useSession(async t=>{var r,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ye}:await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:je})})}catch(t){if(O(t))return Ll(t)&&(await this._removeSession(),await Zt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new ye;const a=n.session;let o=null,c=null;this.flowType==="pkce"&&e.email!=null&&([o,c]=await ze(this.storage,this.storageKey));const{data:u,error:d}=await P(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:c}),jwt:a.access_token,xform:je});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(O(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Os(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ye;const t=Date.now()/1e3;let r=t,n=!0,i=null;const a=Os(e.access_token);if(a.exp&&(r=a.exp,n=r<=t),n){const{session:o,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(O(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ye;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!te())throw new zt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new zt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Ts("Not a valid PKCE flow url.");const t=Pr(window.location.href);if(e){if(!t.code)throw new Ts("No code detected.");const{data:T,error:C}=await this._exchangeCodeForSession(t.code);if(C)throw C;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:T.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new zt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:c,token_type:u}=t;if(!i||!o||!a||!u)throw new zt("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;c&&(f=parseInt(c));const p=f-d;p*1e3<=ut&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=f-h;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,d);const{data:v,error:x}=await this._getUser(i);if(x)throw x;const w={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(t){if(O(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Pr(window.location.href);return!!(te()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Pr(window.location.href),t=await Bt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const a=(r=n.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Dl(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Zt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=jl(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await ze(this.storage,this.storageKey,!0));try{return await P(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(O(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async i=>{var a,o,c,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await P(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return te()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(O(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:a}=t;if(a)throw a;return await P(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Cl(async n=>(n>0&&await Nl(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await P(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:be})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Rr(i)&&Date.now()+a-r<ut})}catch(r){if(this._debug(t,"error",r),O(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),te()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Bt(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<n+Es;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Es}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Rr(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ye;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Sr;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ye;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),O(i)){const a={session:null,error:i};return Rr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $n(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Zt(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ut);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/ut);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ut}ms, refresh threshold is ${Is} ticks`),n<=Is&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Dn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await ze(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await P(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await P(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(O(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(O(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(O(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}}yt.nextInstanceID=0;const Xl=yt;class ec extends Xl{constructor(e){super(e)}}var tc=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(o,c)}u((r=r.apply(s,e||[])).next())})};class rc{constructor(e,t,r){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=vl(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const c=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:cl,realtime:dl,auth:Object.assign(Object.assign({},ul),{storageKey:c}),global:ll},d=yl(r??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=ml(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},d.realtime)),this.rest=new To(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new io(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new il(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return tc(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:a,lock:o,debug:c},u,d){var h;const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ec({url:this.authUrl,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:a,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:(h="Authorization"in this.headers)!==null&&h!==void 0?h:!1})}_initRealtimeClient(e){return new zo(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const sc=(s,e,t)=>new rc(s,e,t),nc="https://tklblvxgprkvletfrsnn.supabase.co",ic="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrbGJsdnhncHJrdmxldGZyc25uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzMxODUwMTMsImV4cCI6MjA0ODc2MTAxM30.8WhBp_PZbLxXXJp8ECO2ezjG3dWc5J8k59bCKvkeOOA",$=sc(nc,ic),ac="admin@carcompare.com",oc="admin123";async function lc(s,e){try{if(s===ac&&e===oc){const{data:a,error:o}=await $.auth.signInWithPassword({email:s,password:e});if(!o&&a.user){const{data:m}=await $.from("profiles").select("*").eq("id",a.user.id).single();return{user:a.user,profile:m,session:a.session}}const{data:{user:c},error:u}=await $.auth.signUp({email:s,password:e,options:{data:{role:"admin"}}});if(u)throw u;if(!c)throw new Error("Failed to create admin user");const{error:d}=await $.rpc("confirm_user",{user_id:c.id});if(d)throw d;const{error:h}=await $.from("profiles").insert({id:c.id,username:s,role:"admin"});if(h)throw h;const{data:f,error:p}=await $.auth.signInWithPassword({email:s,password:e});if(p)throw p;return{user:f.user,profile:{id:c.id,username:s,role:"admin"},session:f.session}}const{data:t,error:r}=await $.auth.signInWithPassword({email:s,password:e});if(r)throw r;const{data:n,error:i}=await $.from("profiles").select("*").eq("id",t.user.id).single();if(i)throw i;if(n.role!=="admin")throw new Error("Unauthorized: Admin access required");return{user:t.user,profile:n,session:t.session}}catch(t){throw console.error("Auth error:",t),t instanceof Error?new Error(t.message):new Error("An unexpected error occurred")}}async function cc(){const{error:s}=await $.auth.signOut();if(s)throw s}async function uc(){const{data:{user:s}}=await $.auth.getUser();if(!s)return null;const{data:e}=await $.from("profiles").select("*").eq("id",s.id).single();return{user:s,profile:e}}const Ln=_.createContext(void 0);function dc({children:s}){const[e,t]=_.useState(null),[r,n]=_.useState(null),[i,a]=_.useState(!0);_.useEffect(()=>{o()},[]);async function o(){try{const h=await uc();t((h==null?void 0:h.user)??null),n((h==null?void 0:h.profile)??null)}catch(h){console.error("Error checking user:",h),t(null),n(null)}finally{a(!1)}}async function c(h,f){const{user:p,profile:m}=await lc(h,f);t(p),n(m)}async function u(){await cc(),t(null),n(null)}const d={user:e,profile:r,isLoading:i,signIn:c,signOut:u};return l.jsx(Ln.Provider,{value:d,children:s})}function Nr(){const s=_.useContext(Ln);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}function Vt({href:s,children:e}){return l.jsx("a",{href:s,className:"text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:e})}function hc(){const{user:s,profile:e,signOut:t}=Nr(),r=nt(),n=async()=>{await t(),r("/")};return l.jsx("header",{className:"bg-white shadow-sm",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center h-16",children:[l.jsxs(Je,{to:"/",className:"flex items-center",children:[l.jsx(Xr,{className:"h-8 w-8 text-blue-600"}),l.jsx("span",{className:"ml-2 text-2xl font-bold text-gray-900",children:"CarCompare"})]}),l.jsxs("nav",{className:"hidden md:flex space-x-8",children:[l.jsx(Vt,{href:"/sell-your-car",children:"Sell Your Car"}),l.jsx(Vt,{href:"#new-cars",children:"New Cars"}),l.jsx(Vt,{href:"#used-cars",children:"Used Cars"}),l.jsx(Vt,{href:"#reviews",children:"Car Reviews"}),(e==null?void 0:e.role)==="admin"&&l.jsx(Je,{to:"/admin/dashboard",className:"text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Admin Dashboard"}),s&&l.jsxs("button",{onClick:n,className:"flex items-center text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:[l.jsx(Vs,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}),l.jsx("div",{className:"md:hidden",children:l.jsx("button",{className:"p-2",children:l.jsx(ni,{className:"h-6 w-6 text-gray-600"})})})]})})})}function fc(){return l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute inset-0 bg-cover bg-center z-0",style:{backgroundImage:'url("https://images.unsplash.com/photo-1492144534655-ae79c964c9d7?auto=format&fit=crop&q=80")'},children:l.jsx("div",{className:"absolute inset-0 bg-black/50"})}),l.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-32",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold tracking-tight text-white sm:text-5xl md:text-6xl",children:"Find your perfect car"}),l.jsx("p",{className:"mt-6 text-xl text-gray-100",children:"Compare prices from trusted dealers and get the best deal"}),l.jsx("div",{className:"mt-10 max-w-xl mx-auto",children:l.jsx("div",{className:"bg-white p-4 rounded-lg shadow-lg",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(ii,{className:"h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search by make, model, or type...",className:"ml-3 flex-1 outline-none text-gray-700"}),l.jsx("button",{className:"ml-4 bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Search"})]})})})]})})]})}async function pc(){const{data:s,error:e}=await $.from("brands").select("*").order("name");if(e)throw console.error("Error fetching brands:",e),e;return s}async function mc(){const{data:s,error:e}=await $.from("cars").select(`
      *,
      brand:brands (
        id,
        name,
        logo_url
      )
    `).eq("condition","new").order("created_at",{ascending:!1});if(e)throw console.error("Error fetching new cars:",e),e;return s}async function gc(){const{data:s,error:e}=await $.from("cars").select(`
      *,
      brand:brands (
        id,
        name,
        logo_url
      )
    `).eq("condition","used").order("created_at",{ascending:!1});if(e)throw console.error("Error fetching used cars:",e),e;return s}function vc(){return vr("newCars",mc,{staleTime:5*60*1e3,retry:3})}function yc(){return vr("usedCars",gc,{staleTime:5*60*1e3,retry:3})}function Un({car:s}){return l.jsx(Je,{to:`/cars/${s.id}`,className:"block",children:l.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden transition-transform hover:scale-[1.02] ${s.is_sold?"opacity-90":""}`,children:[l.jsxs("div",{className:"relative h-48",children:[l.jsx("img",{src:s.image,alt:`${s.make} ${s.model}`,className:"w-full h-full object-cover"}),s.is_sold&&l.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:l.jsx("div",{className:"bg-red-600 text-white px-16 py-6 rounded-full transform -rotate-45 font-bold text-5xl shadow-2xl border-4 border-white",children:"SOLD"})}),!s.is_sold&&s.condition==="used"&&l.jsx("div",{className:"absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Used"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[s.year," ",s.make," ",s.model]}),l.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"From"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["£",s.price.toLocaleString()]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("div",{className:"flex items-center text-green-600",children:[l.jsx(es,{className:"h-4 w-4 mr-1"}),l.jsxs("span",{className:"text-sm",children:["Save £",s.savings.toLocaleString()]})]})})]}),l.jsxs("button",{className:`mt-6 w-full py-2 rounded-md flex items-center justify-center ${s.is_sold?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white transition-colors`,disabled:s.is_sold,children:[l.jsx(ai,{className:"h-4 w-4 mr-2"}),s.is_sold?"Sold Out":"Get best deals"]})]})]})})}function bc(){const{data:s,isLoading:e,error:t}=vc();return e?l.jsx("div",{className:"flex justify-center items-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?l.jsx("div",{className:"text-center py-16 text-red-600",children:"Failed to load new cars. Please try again later."}):s!=null&&s.length?l.jsx("section",{className:"py-16 bg-gray-50",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Featured New Cars"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(r=>l.jsx(Un,{car:r},r.id))})]})}):l.jsx("div",{className:"text-center py-16 text-gray-600",children:"No new cars available at the moment."})}function _c(){const{data:s,isLoading:e,error:t}=yc();return e?l.jsx("div",{className:"flex justify-center items-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?l.jsx("div",{className:"text-center py-16 text-red-600",children:"Failed to load used cars. Please try again later."}):s!=null&&s.length?l.jsx("section",{className:"py-16 bg-white",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Featured Used Cars"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(r=>l.jsx(Un,{car:r},r.id))})]})}):l.jsx("div",{className:"text-center py-16 text-gray-600",children:"No used cars available at the moment."})}function ls(){return vr("brands",pc,{staleTime:5*60*1e3,retry:3})}function xc(){const{data:s,isLoading:e}=ls();return e?l.jsx("div",{className:"flex justify-center items-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l.jsx("section",{className:"py-16 bg-gray-50",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Browse by Brand"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-8",children:s==null?void 0:s.map(t=>l.jsxs("a",{href:`#${t.name.toLowerCase()}`,className:"group flex flex-col items-center justify-center p-6 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[l.jsx("div",{className:"w-20 h-20 mb-4 overflow-hidden rounded-full",children:l.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"})}),l.jsx("span",{className:"text-gray-900 font-medium",children:t.name})]},t.id))})]})})}function wc(){const s=[{icon:l.jsx(Ks,{className:"h-8 w-8 text-blue-600"}),title:"Trusted Dealers",description:"All our dealers are vetted and reviewed for quality service"},{icon:l.jsx(es,{className:"h-8 w-8 text-blue-600"}),title:"Best Prices",description:"Compare prices from multiple dealers to get the best deal"},{icon:l.jsx(oi,{className:"h-8 w-8 text-blue-600"}),title:"Save Money",description:"Average savings of £3,600 on new cars through our platform"}];return l.jsx("section",{className:"py-16 bg-white",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-12",children:"Why Choose CarCompare?"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:s.map((e,t)=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-blue-100 rounded-full",children:e.icon}),l.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-900",children:e.title}),l.jsx("p",{className:"mt-2 text-gray-600",children:e.description})]},t))})]})})}function jc(){return l.jsxs("main",{children:[l.jsx(fc,{}),l.jsx(bc,{}),l.jsx(_c,{}),l.jsx(xc,{}),l.jsx(wc,{})]})}async function kc(){try{const{data:s,error:e}=await $.from("cars").select(`
        *,
        brand:brands (
          id,
          name,
          logo_url
        ),
        images:car_images (
          id,
          image_url,
          display_order
        ),
        features:car_features (
          id,
          name,
          available
        )
      `).order("created_at",{ascending:!1});if(e)throw e;return s}catch(s){throw console.error("Error fetching cars:",s),s}}async function Fn(s){try{const{data:e,error:t}=await $.from("cars").select(`
        *,
        brand:brands (
          id,
          name,
          logo_url
        ),
        images:car_images (
          id,
          image_url,
          display_order
        ),
        features:car_features (
          id,
          name,
          available
        )
      `).eq("id",s).single();if(t)throw t;return e}catch(e){throw console.error("Error fetching car:",e),e}}async function Sc(s){try{const{features:e,...t}=s,{data:r,error:n}=await $.from("cars").insert([t]).select().single();if(n)throw n;if(e&&e.length>0){const{error:i}=await $.rpc("manage_car_features",{p_car_id:r.id,p_features:e});if(i)throw i}return r}catch(e){throw console.error("Error creating car:",e),e}}async function Mn(s,e){try{const{features:t,...r}=e,{data:n,error:i}=await $.from("cars").update(r).eq("id",s).select().single();if(i)throw i;if(t&&t.length>0){const{error:a}=await $.rpc("manage_car_features",{p_car_id:s,p_features:t});if(a)throw a}return n}catch(t){throw console.error("Error updating car:",t),t}}async function Nc(s){try{const{error:e}=await $.from("cars").delete().eq("id",s);if(e)throw e;return!0}catch(e){throw console.error("Error deleting car:",e),e}}function Cc({mileage:s="N/A",fuelType:e,transmission:t,autonomy:r="N/A",seats:n}){const i=[{icon:l.jsx(li,{className:"w-8 h-8 text-gray-600"}),label:"Mileage",value:s},{icon:l.jsx(ci,{className:"w-8 h-8 text-gray-600"}),label:"Fuel Type",value:e},{icon:l.jsx(ui,{className:"w-8 h-8 text-gray-600"}),label:"Transmission",value:t},{icon:l.jsx(di,{className:"w-8 h-8 text-gray-600"}),label:"Autonomy",value:r},{icon:l.jsx(hi,{className:"w-8 h-8 text-gray-600"}),label:"Seats",value:n}];return l.jsxs("div",{className:"w-full",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 pb-2 border-b-4 border-blue-600 inline-block",children:"Car Overview"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-6",children:i.map((a,o)=>l.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg text-center",children:[l.jsx("div",{className:"flex justify-center mb-3",children:a.icon}),l.jsx("p",{className:"text-gray-600 text-sm mb-1",children:a.label}),l.jsx("p",{className:"font-semibold text-gray-900",children:a.value})]},o))})]})}function Ec({bodyType:s,exteriorColor:e,numberOfOwners:t,numberOfKeys:r="n/a",interiorColor:n,condition:i}){const a=[{icon:l.jsx(Xr,{className:"w-5 h-5"}),label:"Body Type",value:s},{icon:l.jsx(fi,{className:"w-5 h-5"}),label:"Exterior Color",value:e},{icon:l.jsx(pi,{className:"w-5 h-5"}),label:"Number Of Owners",value:t},{icon:l.jsx(mi,{className:"w-5 h-5"}),label:"Number Of Keys",value:r},{icon:l.jsx(gi,{className:"w-5 h-5"}),label:"Interior Color",value:n},{icon:l.jsx(Ks,{className:"w-5 h-5"}),label:"Condition",value:i}];return l.jsxs("div",{className:"w-full mt-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 pb-2 border-b-4 border-blue-600 inline-block",children:"Summary"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map((o,c)=>l.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[o.icon,l.jsx("span",{className:"text-gray-600",children:o.label})]}),l.jsx("span",{className:"font-bold text-gray-900 uppercase",children:o.value})]},c))})]})}function Oc({features:s}){return l.jsxs("div",{className:"w-full mt-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 pb-2 border-b-4 border-blue-600 inline-block",children:"Features"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:s.map((e,t)=>l.jsxs("div",{className:"flex items-center gap-2",children:[e.available?l.jsx(Hs,{className:"w-5 h-5 text-green-500"}):l.jsx("span",{className:"w-5 h-5 block"}),l.jsx("span",{className:"text-gray-700",children:e.name})]},t))})]})}function Tc({images:s,alt:e,className:t=""}){const[r,n]=_.useState(0),i=s.filter(u=>u&&u.trim().length>0);if(!i.length)return null;const a=u=>{u.preventDefault(),u.stopPropagation(),n(d=>(d+1)%i.length)},o=u=>{u.preventDefault(),u.stopPropagation(),n(d=>(d-1+i.length)%i.length)},c=(u,d)=>{d.preventDefault(),d.stopPropagation(),n(u)};return l.jsxs("div",{className:`relative h-full overflow-hidden group ${t}`,children:[l.jsx("div",{className:"relative h-full",children:i.map((u,d)=>l.jsx("img",{src:u,alt:`${e} - Image ${d+1}`,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-300 ${d===r?"opacity-100":"opacity-0"}`,loading:d===0?"eager":"lazy"},d))}),i.length>1&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:o,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 z-20","aria-label":"Previous image",children:l.jsx(vi,{className:"h-6 w-6"})}),l.jsx("button",{onClick:a,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200 z-20","aria-label":"Next image",children:l.jsx(yi,{className:"h-6 w-6"})}),l.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-20",children:i.map((u,d)=>l.jsx("button",{onClick:h=>c(d,h),className:`w-2.5 h-2.5 rounded-full transition-all duration-200 ${d===r?"bg-white scale-110":"bg-white/50 hover:bg-white/75"}`,"aria-label":`Go to image ${d+1}`},d))}),l.jsxs("div",{className:"absolute top-4 right-4 bg-black/50 text-white px-3 py-1 rounded-full text-sm z-20",children:[r+1," / ",i.length]})]})]})}function Pc(){var f,p;const{id:s}=Zs(),e=nt(),[t,r]=_.useState(null),[n,i]=_.useState(!0),[a,o]=_.useState(null),[c,u]=_.useState(!1);_.useEffect(()=>{if(!s){e("/");return}d(s)},[s,e]);async function d(m){try{i(!0);const v=await Fn(m);r(v)}catch(v){console.error("Error loading car:",v),o("Failed to load car details")}finally{i(!1)}}if(n)return l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(a||!t)return l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:a||"Car not found"}),l.jsx("button",{onClick:()=>e("/"),className:"text-blue-600 hover:text-blue-800",children:"Return to home"})]});const h=[t.image,...((f=t.images)==null?void 0:f.map(m=>m.image_url))||[]];return l.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("h1",{className:"text-4xl font-bold text-gray-900",children:[t.year," ",t.make," ",t.model]}),l.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.condition==="new"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.condition.charAt(0).toUpperCase()+t.condition.slice(1)}),t.is_sold&&l.jsx("span",{className:"px-3 py-1 rounded-full bg-red-100 text-red-800 text-sm font-medium",children:"Sold"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[l.jsxs("div",{className:"relative h-[400px]",children:[l.jsx(Tc,{images:h,alt:`${t.make} ${t.model}`,className:"h-full"}),t.is_sold&&l.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:l.jsx("div",{className:"bg-red-600 text-white px-16 py-6 rounded-full transform -rotate-45 font-bold text-5xl shadow-2xl border-4 border-white",children:"SOLD"})})]}),t.video_url&&l.jsxs("div",{className:"mt-4 p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Watch Video Tour"}),l.jsx("div",{className:"relative aspect-video bg-black rounded-lg overflow-hidden",children:c?l.jsx("video",{src:t.video_url,controls:!0,autoPlay:!0,className:"absolute inset-0 w-full h-full",children:"Your browser does not support the video tag."}):l.jsx("div",{className:"absolute inset-0 bg-cover bg-center cursor-pointer group",style:{backgroundImage:`url(${t.image})`},onClick:()=>u(!0),children:l.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center group-hover:bg-black/50 transition-colors",children:l.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform",children:l.jsx(bi,{className:"w-8 h-8 text-blue-600 ml-1"})})})})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Price"}),l.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:["£",t.price.toLocaleString()]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Savings"}),l.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["£",t.savings.toLocaleString()]})]})]}),l.jsx("button",{className:`w-full py-3 px-4 rounded-lg text-white font-medium ${t.is_sold?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,disabled:t.is_sold,children:t.is_sold?"Sold Out":"Get Best Deal"}),!t.is_sold&&l.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-green-600",children:[l.jsx(es,{className:"h-5 w-5"}),l.jsx("span",{children:"Best price guaranteed"})]})]})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsx(Cc,{mileage:t.mileage||"N/A",fuelType:t.fuel_type||"N/A",transmission:t.transmission||"N/A",autonomy:t.autonomy||"N/A",seats:t.seats||5}),l.jsx(Ec,{bodyType:t.body_type||"N/A",exteriorColor:t.exterior_color||"N/A",numberOfOwners:t.number_of_owners||1,numberOfKeys:t.number_of_keys||"N/A",interiorColor:t.interior_color||"N/A",condition:t.condition.toUpperCase()}),l.jsx(Oc,{features:((p=t.features)==null?void 0:p.map(m=>({name:m.name,available:m.available})))||[]})]})]})})}const Ls="car_images",Us="car_videos";async function qn(s){try{const e=s.name.split(".").pop(),r=`${Math.random().toString(36).substring(2)}-${Date.now()}.${e}`,{error:n}=await $.storage.from(Ls).upload(r,s,{cacheControl:"3600",upsert:!1});if(n)throw n;const{data:{publicUrl:i}}=$.storage.from(Ls).getPublicUrl(r);return i}catch(e){throw console.error("Error uploading image:",e),e}}async function Ac(s){try{if(!s.type.startsWith("video/"))throw new Error("Please upload a video file");if(s.size>100*1024*1024)throw new Error("Video size should be less than 100MB");const e=s.name.split(".").pop(),r=`${Math.random().toString(36).substring(2)}-${Date.now()}.${e}`,{error:n}=await $.storage.from(Us).upload(r,s,{cacheControl:"3600",upsert:!1});if(n)throw n;const{data:{publicUrl:i}}=$.storage.from(Us).getPublicUrl(r);return i}catch(e){throw console.error("Error uploading video:",e),e}}async function Rc(s){const e=s.map(t=>qn(t));return Promise.all(e)}function $c({onImageUploaded:s,onImagesUploaded:e,multiple:t=!1,className:r="",existingImages:n=[],onImageRemoved:i}){const[a,o]=_.useState(!1),[c,u]=_.useState(null),[d,h]=_.useState(n),f=v=>{if(!v.type.startsWith("image/"))throw new Error("Please upload an image file");if(v.size>5*1024*1024)throw new Error("Image size should be less than 5MB")},p=async v=>{const x=Array.from(v.target.files||[]);if(x.length)try{if(o(!0),u(null),x.forEach(f),t){const w=await Rc(x);h(T=>[...T,...w]),e==null||e(w)}else{const w=await qn(x[0]);h([w]),s(w)}}catch(w){u(w instanceof Error?w.message:"Failed to upload image"),console.error("Upload error:",w)}finally{o(!1)}},m=v=>{h(x=>x.filter(w=>w!==v)),i==null||i(v)};return l.jsxs("div",{className:`relative ${r}`,children:[l.jsxs("label",{className:"block",children:[l.jsx("span",{className:"sr-only",children:"Choose car images"}),l.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400 transition-colors",children:l.jsxs("div",{className:"space-y-1 text-center",children:[l.jsx(Ws,{className:"mx-auto h-12 w-12 text-gray-400"}),l.jsxs("div",{className:"flex text-sm text-gray-600",children:[l.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[l.jsx("span",{children:"Upload images"}),l.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",multiple:t,onChange:p,disabled:a})]}),l.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB each"})]})})]}),c&&l.jsx("p",{className:"mt-2 text-sm text-red-600",children:c}),a&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),d.length>0&&l.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-4",children:d.map((v,x)=>l.jsxs("div",{className:"relative group",children:[l.jsx("img",{src:v,alt:`Preview ${x+1}`,className:"w-full h-32 object-cover rounded-md"}),l.jsx("button",{onClick:()=>m(v),className:"absolute top-2 right-2 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove image",children:l.jsx(pr,{className:"h-4 w-4"})})]},v))})]})}function Ic({onVideoUploaded:s,className:e="",existingVideo:t,onVideoRemoved:r}){const[n,i]=_.useState(!1),[a,o]=_.useState(null),[c,u]=_.useState(t||null),d=async f=>{var m;const p=(m=f.target.files)==null?void 0:m[0];if(p)try{i(!0),o(null);const v=await Ac(p);u(v),s(v)}catch(v){o(v instanceof Error?v.message:"Failed to upload video"),console.error("Upload error:",v)}finally{i(!1)}},h=()=>{u(null),r==null||r()};return l.jsxs("div",{className:`relative ${e}`,children:[l.jsxs("label",{className:"block",children:[l.jsx("span",{className:"sr-only",children:"Choose car video"}),l.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400 transition-colors",children:l.jsxs("div",{className:"space-y-1 text-center",children:[l.jsx(Ws,{className:"mx-auto h-12 w-12 text-gray-400"}),l.jsxs("div",{className:"flex text-sm text-gray-600",children:[l.jsxs("label",{htmlFor:"video-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[l.jsx("span",{children:"Upload a video"}),l.jsx("input",{id:"video-upload",name:"video-upload",type:"file",className:"sr-only",accept:"video/*",onChange:d,disabled:n})]}),l.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"MP4, WebM up to 100MB"})]})})]}),a&&l.jsx("p",{className:"mt-2 text-sm text-red-600",children:a}),n&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),c&&l.jsx("div",{className:"mt-4",children:l.jsx("div",{className:"relative group",children:l.jsxs("div",{className:"flex items-center gap-2 p-4 bg-gray-50 rounded-lg",children:[l.jsx(_i,{className:"h-6 w-6 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-700 truncate flex-1",children:"Video uploaded successfully"}),l.jsx("button",{onClick:h,className:"p-1 text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Remove video",children:l.jsx(pr,{className:"h-5 w-5"})})]})})})]})}var A;(function(s){s.assertEqual=n=>n;function e(n){}s.assertIs=e;function t(n){throw new Error}s.assertNever=t,s.arrayToEnum=n=>{const i={};for(const a of n)i[a]=a;return i},s.getValidEnumValues=n=>{const i=s.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),a={};for(const o of i)a[o]=n[o];return s.objectValues(a)},s.objectValues=n=>s.objectKeys(n).map(function(i){return n[i]}),s.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&i.push(a);return i},s.find=(n,i)=>{for(const a of n)if(i(a))return a},s.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function r(n,i=" | "){return n.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}s.joinValues=r,s.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(A||(A={}));var Wr;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(Wr||(Wr={}));const b=A.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ke=s=>{switch(typeof s){case"undefined":return b.undefined;case"string":return b.string;case"number":return isNaN(s)?b.nan:b.number;case"boolean":return b.boolean;case"function":return b.function;case"bigint":return b.bigint;case"symbol":return b.symbol;case"object":return Array.isArray(s)?b.array:s===null?b.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?b.promise:typeof Map<"u"&&s instanceof Map?b.map:typeof Set<"u"&&s instanceof Set?b.set:typeof Date<"u"&&s instanceof Date?b.date:b.object;default:return b.unknown}},g=A.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Dc=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class Y extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},r={_errors:[]},n=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(n);else if(a.code==="invalid_return_type")n(a.returnTypeError);else if(a.code==="invalid_arguments")n(a.argumentsError);else if(a.path.length===0)r._errors.push(t(a));else{let o=r,c=0;for(;c<a.path.length;){const u=a.path[c];c===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(t(a))):o[u]=o[u]||{_errors:[]},o=o[u],c++}}};return n(this),r}static assert(e){if(!(e instanceof Y))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,A.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Y.create=s=>new Y(s);const tt=(s,e)=>{let t;switch(s.code){case g.invalid_type:s.received===b.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case g.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,A.jsonStringifyReplacer)}`;break;case g.unrecognized_keys:t=`Unrecognized key(s) in object: ${A.joinValues(s.keys,", ")}`;break;case g.invalid_union:t="Invalid input";break;case g.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${A.joinValues(s.options)}`;break;case g.invalid_enum_value:t=`Invalid enum value. Expected ${A.joinValues(s.options)}, received '${s.received}'`;break;case g.invalid_arguments:t="Invalid function arguments";break;case g.invalid_return_type:t="Invalid function return type";break;case g.invalid_date:t="Invalid date";break;case g.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:A.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case g.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case g.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case g.custom:t="Invalid input";break;case g.invalid_intersection_types:t="Intersection results could not be merged";break;case g.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case g.not_finite:t="Number must be finite";break;default:t=e.defaultError,A.assertNever(s)}return{message:t}};let Bn=tt;function Lc(s){Bn=s}function or(){return Bn}const lr=s=>{const{data:e,path:t,errorMaps:r,issueData:n}=s,i=[...t,...n.path||[]],a={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const c=r.filter(u=>!!u).slice().reverse();for(const u of c)o=u(a,{data:e,defaultError:o}).message;return{...n,path:i,message:o}},Uc=[];function y(s,e){const t=or(),r=lr({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===tt?void 0:tt].filter(n=>!!n)});s.common.issues.push(r)}class z{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if(n.status==="aborted")return S;n.status==="dirty"&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const n of t){const i=await n.key,a=await n.value;r.push({key:i,value:a})}return z.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:i,value:a}=n;if(i.status==="aborted"||a.status==="aborted")return S;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||n.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const S=Object.freeze({status:"aborted"}),He=s=>({status:"dirty",value:s}),V=s=>({status:"valid",value:s}),Jr=s=>s.status==="aborted",Gr=s=>s.status==="dirty",bt=s=>s.status==="valid",_t=s=>typeof Promise<"u"&&s instanceof Promise;function cr(s,e,t,r){if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(s)}function Zn(s,e,t,r,n){if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}var j;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(j||(j={}));var ht,ft;class le{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Fs=(s,e)=>{if(bt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Y(s.common.issues);return this._error=t,this._error}}};function N(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:n}=s;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(a,o)=>{var c,u;const{message:d}=s;return a.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=d??t)!==null&&u!==void 0?u:o.defaultError}},description:n}}class E{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ke(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ke(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new z,ctx:{common:e.parent.common,data:e.data,parsedType:ke(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(_t(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ke(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Fs(n,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ke(e)},n=this._parse({data:e,path:r.path,parent:r}),i=await(_t(n)?n:Promise.resolve(n));return Fs(r,i)}refine(e,t){const r=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,i)=>{const a=e(n),o=()=>i.addIssue({code:g.custom,...r(n)});return typeof Promise<"u"&&a instanceof Promise?a.then(c=>c?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,n)=>e(r)?!0:(n.addIssue(typeof t=="function"?t(r,n):t),!1))}_refinement(e){return new ie({schema:this,typeName:k.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return oe.create(this,this._def)}nullable(){return Ee.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ne.create(this,this._def)}promise(){return st.create(this,this._def)}or(e){return kt.create([this,e],this._def)}and(e){return St.create(this,e,this._def)}transform(e){return new ie({...N(this._def),schema:this,typeName:k.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Tt({...N(this._def),innerType:this,defaultValue:t,typeName:k.ZodDefault})}brand(){return new cs({typeName:k.ZodBranded,type:this,...N(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Pt({...N(this._def),innerType:this,catchValue:t,typeName:k.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Ut.create(this,e)}readonly(){return At.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fc=/^c[^\s-]{8,}$/i,Mc=/^[0-9a-z]+$/,qc=/^[0-9A-HJKMNP-TV-Z]{26}$/,Bc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Zc=/^[a-z0-9_-]{21}$/i,Qc=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Vc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let $r;const Kc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Hc=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Wc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Qn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Jc=new RegExp(`^${Qn}$`);function zn(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Gc(s){return new RegExp(`^${zn(s)}$`)}function Vn(s){let e=`${Qn}T${zn(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Yc(s,e){return!!((e==="v4"||!e)&&Kc.test(s)||(e==="v6"||!e)&&Hc.test(s))}class se extends E{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==b.string){const i=this._getOrReturnCtx(e);return y(i,{code:g.invalid_type,expected:b.string,received:i.parsedType}),S}const r=new z;let n;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(n=this._getOrReturnCtx(e,n),a?y(n,{code:g.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&y(n,{code:g.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")zc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"email",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")$r||($r=new RegExp(Vc,"u")),$r.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"emoji",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Bc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"uuid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Zc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"nanoid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Fc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"cuid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Mc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"cuid2",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")qc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"ulid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),y(n,{validation:"url",code:g.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"regex",code:g.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Vn(i).test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Jc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Gc(i).test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Qc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"duration",code:g.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Yc(e.data,i.version)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"ip",code:g.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Wc.test(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{validation:"base64",code:g.invalid_string,message:i.message}),r.dirty()):A.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(n=>e.test(n),{validation:t,code:g.invalid_string,...j.errToObj(r)})}_addCheck(e){return new se({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...j.errToObj(e)})}url(e){return this._addCheck({kind:"url",...j.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...j.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...j.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...j.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...j.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...j.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...j.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...j.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...j.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...j.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...j.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...j.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...j.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...j.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...j.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...j.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...j.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...j.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...j.errToObj(t)})}nonempty(e){return this.min(1,j.errToObj(e))}trim(){return new se({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new se({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new se({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}se.create=s=>{var e;return new se({checks:[],typeName:k.ZodString,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...N(s)})};function Xc(s,e){const t=(s.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,n=t>r?t:r,i=parseInt(s.toFixed(n).replace(".","")),a=parseInt(e.toFixed(n).replace(".",""));return i%a/Math.pow(10,n)}class Se extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==b.number){const i=this._getOrReturnCtx(e);return y(i,{code:g.invalid_type,expected:b.number,received:i.parsedType}),S}let r;const n=new z;for(const i of this._def.checks)i.kind==="int"?A.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:g.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?Xc(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:g.not_finite,message:i.message}),n.dirty()):A.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,j.toString(t))}gt(e,t){return this.setLimit("min",e,!1,j.toString(t))}lte(e,t){return this.setLimit("max",e,!0,j.toString(t))}lt(e,t){return this.setLimit("max",e,!1,j.toString(t))}setLimit(e,t,r,n){return new Se({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:j.toString(n)}]})}_addCheck(e){return new Se({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:j.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:j.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:j.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:j.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:j.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:j.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&A.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Se.create=s=>new Se({checks:[],typeName:k.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...N(s)});class Ne extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==b.bigint){const i=this._getOrReturnCtx(e);return y(i,{code:g.invalid_type,expected:b.bigint,received:i.parsedType}),S}let r;const n=new z;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),y(r,{code:g.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):A.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,j.toString(t))}gt(e,t){return this.setLimit("min",e,!1,j.toString(t))}lte(e,t){return this.setLimit("max",e,!0,j.toString(t))}lt(e,t){return this.setLimit("max",e,!1,j.toString(t))}setLimit(e,t,r,n){return new Ne({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:j.toString(n)}]})}_addCheck(e){return new Ne({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:j.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:j.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ne.create=s=>{var e;return new Ne({checks:[],typeName:k.ZodBigInt,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...N(s)})};class xt extends E{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==b.boolean){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.boolean,received:r.parsedType}),S}return V(e.data)}}xt.create=s=>new xt({typeName:k.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...N(s)});class Ue extends E{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==b.date){const i=this._getOrReturnCtx(e);return y(i,{code:g.invalid_type,expected:b.date,received:i.parsedType}),S}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return y(i,{code:g.invalid_date}),S}const r=new z;let n;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):A.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ue({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:j.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:j.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ue.create=s=>new Ue({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:k.ZodDate,...N(s)});class ur extends E{_parse(e){if(this._getType(e)!==b.symbol){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.symbol,received:r.parsedType}),S}return V(e.data)}}ur.create=s=>new ur({typeName:k.ZodSymbol,...N(s)});class wt extends E{_parse(e){if(this._getType(e)!==b.undefined){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.undefined,received:r.parsedType}),S}return V(e.data)}}wt.create=s=>new wt({typeName:k.ZodUndefined,...N(s)});class jt extends E{_parse(e){if(this._getType(e)!==b.null){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.null,received:r.parsedType}),S}return V(e.data)}}jt.create=s=>new jt({typeName:k.ZodNull,...N(s)});class rt extends E{constructor(){super(...arguments),this._any=!0}_parse(e){return V(e.data)}}rt.create=s=>new rt({typeName:k.ZodAny,...N(s)});class Le extends E{constructor(){super(...arguments),this._unknown=!0}_parse(e){return V(e.data)}}Le.create=s=>new Le({typeName:k.ZodUnknown,...N(s)});class fe extends E{_parse(e){const t=this._getOrReturnCtx(e);return y(t,{code:g.invalid_type,expected:b.never,received:t.parsedType}),S}}fe.create=s=>new fe({typeName:k.ZodNever,...N(s)});class dr extends E{_parse(e){if(this._getType(e)!==b.undefined){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.void,received:r.parsedType}),S}return V(e.data)}}dr.create=s=>new dr({typeName:k.ZodVoid,...N(s)});class ne extends E{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==b.array)return y(t,{code:g.invalid_type,expected:b.array,received:t.parsedType}),S;if(n.exactLength!==null){const a=t.data.length>n.exactLength.value,o=t.data.length<n.exactLength.value;(a||o)&&(y(t,{code:a?g.too_big:g.too_small,minimum:o?n.exactLength.value:void 0,maximum:a?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(y(t,{code:g.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(y(t,{code:g.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>n.type._parseAsync(new le(t,a,t.path,o)))).then(a=>z.mergeArray(r,a));const i=[...t.data].map((a,o)=>n.type._parseSync(new le(t,a,t.path,o)));return z.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new ne({...this._def,minLength:{value:e,message:j.toString(t)}})}max(e,t){return new ne({...this._def,maxLength:{value:e,message:j.toString(t)}})}length(e,t){return new ne({...this._def,exactLength:{value:e,message:j.toString(t)}})}nonempty(e){return this.min(1,e)}}ne.create=(s,e)=>new ne({type:s,minLength:null,maxLength:null,exactLength:null,typeName:k.ZodArray,...N(e)});function Ke(s){if(s instanceof L){const e={};for(const t in s.shape){const r=s.shape[t];e[t]=oe.create(Ke(r))}return new L({...s._def,shape:()=>e})}else return s instanceof ne?new ne({...s._def,type:Ke(s.element)}):s instanceof oe?oe.create(Ke(s.unwrap())):s instanceof Ee?Ee.create(Ke(s.unwrap())):s instanceof ce?ce.create(s.items.map(e=>Ke(e))):s}class L extends E{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=A.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==b.object){const u=this._getOrReturnCtx(e);return y(u,{code:g.invalid_type,expected:b.object,received:u.parsedType}),S}const{status:r,ctx:n}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof fe&&this._def.unknownKeys==="strip"))for(const u in n.data)a.includes(u)||o.push(u);const c=[];for(const u of a){const d=i[u],h=n.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new le(n,h,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof fe){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)c.push({key:{status:"valid",value:d},value:{status:"valid",value:n.data[d]}});else if(u==="strict")o.length>0&&(y(n,{code:g.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const h=n.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new le(n,h,n.path,d)),alwaysSet:d in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of c){const h=await d.key,f=await d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u}).then(u=>z.mergeObjectSync(r,u)):z.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return j.errToObj,new L({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var n,i,a,o;const c=(a=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,t,r).message)!==null&&a!==void 0?a:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=j.errToObj(e).message)!==null&&o!==void 0?o:c}:{message:c}}}:{}})}strip(){return new L({...this._def,unknownKeys:"strip"})}passthrough(){return new L({...this._def,unknownKeys:"passthrough"})}extend(e){return new L({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new L({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:k.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new L({...this._def,catchall:e})}pick(e){const t={};return A.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new L({...this._def,shape:()=>t})}omit(e){const t={};return A.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new L({...this._def,shape:()=>t})}deepPartial(){return Ke(this)}partial(e){const t={};return A.objectKeys(this.shape).forEach(r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new L({...this._def,shape:()=>t})}required(e){const t={};return A.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof oe;)i=i._def.innerType;t[r]=i}}),new L({...this._def,shape:()=>t})}keyof(){return Kn(A.objectKeys(this.shape))}}L.create=(s,e)=>new L({shape:()=>s,unknownKeys:"strip",catchall:fe.create(),typeName:k.ZodObject,...N(e)});L.strictCreate=(s,e)=>new L({shape:()=>s,unknownKeys:"strict",catchall:fe.create(),typeName:k.ZodObject,...N(e)});L.lazycreate=(s,e)=>new L({shape:s,unknownKeys:"strip",catchall:fe.create(),typeName:k.ZodObject,...N(e)});class kt extends E{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Y(o.ctx.common.issues));return y(t,{code:g.invalid_union,unionErrors:a}),S}if(t.common.async)return Promise.all(r.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(n);{let i;const a=[];for(const c of r){const u={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(c=>new Y(c));return y(t,{code:g.invalid_union,unionErrors:o}),S}}get options(){return this._def.options}}kt.create=(s,e)=>new kt({options:s,typeName:k.ZodUnion,...N(e)});const de=s=>s instanceof Ct?de(s.schema):s instanceof ie?de(s.innerType()):s instanceof Et?[s.value]:s instanceof Ce?s.options:s instanceof Ot?A.objectValues(s.enum):s instanceof Tt?de(s._def.innerType):s instanceof wt?[void 0]:s instanceof jt?[null]:s instanceof oe?[void 0,...de(s.unwrap())]:s instanceof Ee?[null,...de(s.unwrap())]:s instanceof cs||s instanceof At?de(s.unwrap()):s instanceof Pt?de(s._def.innerType):[];class Cr extends E{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.object)return y(t,{code:g.invalid_type,expected:b.object,received:t.parsedType}),S;const r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(y(t,{code:g.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),S)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const i of t){const a=de(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(n.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);n.set(o,i)}}return new Cr({typeName:k.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...N(r)})}}function Yr(s,e){const t=ke(s),r=ke(e);if(s===e)return{valid:!0,data:s};if(t===b.object&&r===b.object){const n=A.objectKeys(e),i=A.objectKeys(s).filter(o=>n.indexOf(o)!==-1),a={...s,...e};for(const o of i){const c=Yr(s[o],e[o]);if(!c.valid)return{valid:!1};a[o]=c.data}return{valid:!0,data:a}}else if(t===b.array&&r===b.array){if(s.length!==e.length)return{valid:!1};const n=[];for(let i=0;i<s.length;i++){const a=s[i],o=e[i],c=Yr(a,o);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return t===b.date&&r===b.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class St extends E{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(i,a)=>{if(Jr(i)||Jr(a))return S;const o=Yr(i.value,a.value);return o.valid?((Gr(i)||Gr(a))&&t.dirty(),{status:t.value,value:o.data}):(y(r,{code:g.invalid_intersection_types}),S)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>n(i,a)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}St.create=(s,e,t)=>new St({left:s,right:e,typeName:k.ZodIntersection,...N(t)});class ce extends E{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==b.array)return y(r,{code:g.invalid_type,expected:b.array,received:r.parsedType}),S;if(r.data.length<this._def.items.length)return y(r,{code:g.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),S;!this._def.rest&&r.data.length>this._def.items.length&&(y(r,{code:g.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((a,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new le(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>z.mergeArray(t,a)):z.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ce({...this._def,rest:e})}}ce.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ce({items:s,typeName:k.ZodTuple,rest:null,...N(e)})};class Nt extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==b.object)return y(r,{code:g.invalid_type,expected:b.object,received:r.parsedType}),S;const n=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)n.push({key:i._parse(new le(r,o,r.path,o)),value:a._parse(new le(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?z.mergeObjectAsync(t,n):z.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof E?new Nt({keyType:e,valueType:t,typeName:k.ZodRecord,...N(r)}):new Nt({keyType:se.create(),valueType:e,typeName:k.ZodRecord,...N(t)})}}class hr extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==b.map)return y(r,{code:g.invalid_type,expected:b.map,received:r.parsedType}),S;const n=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,c],u)=>({key:n._parse(new le(r,o,r.path,[u,"key"])),value:i._parse(new le(r,c,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of a){const u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return S;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(u.value,d.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const c of a){const u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return S;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(u.value,d.value)}return{status:t.value,value:o}}}}hr.create=(s,e,t)=>new hr({valueType:e,keyType:s,typeName:k.ZodMap,...N(t)});class Fe extends E{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==b.set)return y(r,{code:g.invalid_type,expected:b.set,received:r.parsedType}),S;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(y(r,{code:g.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(y(r,{code:g.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const i=this._def.valueType;function a(c){const u=new Set;for(const d of c){if(d.status==="aborted")return S;d.status==="dirty"&&t.dirty(),u.add(d.value)}return{status:t.value,value:u}}const o=[...r.data.values()].map((c,u)=>i._parse(new le(r,c,r.path,u)));return r.common.async?Promise.all(o).then(c=>a(c)):a(o)}min(e,t){return new Fe({...this._def,minSize:{value:e,message:j.toString(t)}})}max(e,t){return new Fe({...this._def,maxSize:{value:e,message:j.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Fe.create=(s,e)=>new Fe({valueType:s,minSize:null,maxSize:null,typeName:k.ZodSet,...N(e)});class Ye extends E{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.function)return y(t,{code:g.invalid_type,expected:b.function,received:t.parsedType}),S;function r(o,c){return lr({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,or(),tt].filter(u=>!!u),issueData:{code:g.invalid_arguments,argumentsError:c}})}function n(o,c){return lr({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,or(),tt].filter(u=>!!u),issueData:{code:g.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof st){const o=this;return V(async function(...c){const u=new Y([]),d=await o._def.args.parseAsync(c,i).catch(p=>{throw u.addIssue(r(c,p)),u}),h=await Reflect.apply(a,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(p=>{throw u.addIssue(n(h,p)),u})})}else{const o=this;return V(function(...c){const u=o._def.args.safeParse(c,i);if(!u.success)throw new Y([r(c,u.error)]);const d=Reflect.apply(a,this,u.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Y([n(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ye({...this._def,args:ce.create(e).rest(Le.create())})}returns(e){return new Ye({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Ye({args:e||ce.create([]).rest(Le.create()),returns:t||Le.create(),typeName:k.ZodFunction,...N(r)})}}class Ct extends E{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ct.create=(s,e)=>new Ct({getter:s,typeName:k.ZodLazy,...N(e)});class Et extends E{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return y(t,{received:t.data,code:g.invalid_literal,expected:this._def.value}),S}return{status:"valid",value:e.data}}get value(){return this._def.value}}Et.create=(s,e)=>new Et({value:s,typeName:k.ZodLiteral,...N(e)});function Kn(s,e){return new Ce({values:s,typeName:k.ZodEnum,...N(e)})}class Ce extends E{constructor(){super(...arguments),ht.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return y(t,{expected:A.joinValues(r),received:t.parsedType,code:g.invalid_type}),S}if(cr(this,ht)||Zn(this,ht,new Set(this._def.values)),!cr(this,ht).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return y(t,{received:t.data,code:g.invalid_enum_value,options:r}),S}return V(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ce.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ce.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}ht=new WeakMap;Ce.create=Kn;class Ot extends E{constructor(){super(...arguments),ft.set(this,void 0)}_parse(e){const t=A.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==b.string&&r.parsedType!==b.number){const n=A.objectValues(t);return y(r,{expected:A.joinValues(n),received:r.parsedType,code:g.invalid_type}),S}if(cr(this,ft)||Zn(this,ft,new Set(A.getValidEnumValues(this._def.values))),!cr(this,ft).has(e.data)){const n=A.objectValues(t);return y(r,{received:r.data,code:g.invalid_enum_value,options:n}),S}return V(e.data)}get enum(){return this._def.values}}ft=new WeakMap;Ot.create=(s,e)=>new Ot({values:s,typeName:k.ZodNativeEnum,...N(e)});class st extends E{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.promise&&t.common.async===!1)return y(t,{code:g.invalid_type,expected:b.promise,received:t.parsedType}),S;const r=t.parsedType===b.promise?t.data:Promise.resolve(t.data);return V(r.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}}st.create=(s,e)=>new st({type:s,typeName:k.ZodPromise,...N(e)});class ie extends E{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===k.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:a=>{y(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const a=n.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return S;const c=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return c.status==="aborted"?S:c.status==="dirty"||t.value==="dirty"?He(c.value):c});{if(t.value==="aborted")return S;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?S:o.status==="dirty"||t.value==="dirty"?He(o.value):o}}if(n.type==="refinement"){const a=o=>{const c=n.refinement(o,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?S:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?S:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(n.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!bt(a))return a;const o=n.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>bt(a)?Promise.resolve(n.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);A.assertNever(n)}}ie.create=(s,e,t)=>new ie({schema:s,typeName:k.ZodEffects,effect:e,...N(t)});ie.createWithPreprocess=(s,e,t)=>new ie({schema:e,effect:{type:"preprocess",transform:s},typeName:k.ZodEffects,...N(t)});class oe extends E{_parse(e){return this._getType(e)===b.undefined?V(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}oe.create=(s,e)=>new oe({innerType:s,typeName:k.ZodOptional,...N(e)});class Ee extends E{_parse(e){return this._getType(e)===b.null?V(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ee.create=(s,e)=>new Ee({innerType:s,typeName:k.ZodNullable,...N(e)});class Tt extends E{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===b.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Tt.create=(s,e)=>new Tt({innerType:s,typeName:k.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...N(e)});class Pt extends E{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return _t(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Y(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Y(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Pt.create=(s,e)=>new Pt({innerType:s,typeName:k.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...N(e)});class fr extends E{_parse(e){if(this._getType(e)!==b.nan){const r=this._getOrReturnCtx(e);return y(r,{code:g.invalid_type,expected:b.nan,received:r.parsedType}),S}return{status:"valid",value:e.data}}}fr.create=s=>new fr({typeName:k.ZodNaN,...N(s)});const eu=Symbol("zod_brand");class cs extends E{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Ut extends E{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?S:i.status==="dirty"?(t.dirty(),He(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?S:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(e,t){return new Ut({in:e,out:t,typeName:k.ZodPipeline})}}class At extends E{_parse(e){const t=this._def.innerType._parse(e),r=n=>(bt(n)&&(n.value=Object.freeze(n.value)),n);return _t(t)?t.then(n=>r(n)):r(t)}unwrap(){return this._def.innerType}}At.create=(s,e)=>new At({innerType:s,typeName:k.ZodReadonly,...N(e)});function Hn(s,e={},t){return s?rt.create().superRefine((r,n)=>{var i,a;if(!s(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(a=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,u=typeof o=="string"?{message:o}:o;n.addIssue({code:"custom",...u,fatal:c})}}):rt.create()}const tu={object:L.lazycreate};var k;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(k||(k={}));const ru=(s,e={message:`Input not instance of ${s.name}`})=>Hn(t=>t instanceof s,e),Wn=se.create,Jn=Se.create,su=fr.create,nu=Ne.create,Gn=xt.create,iu=Ue.create,au=ur.create,ou=wt.create,lu=jt.create,cu=rt.create,uu=Le.create,du=fe.create,hu=dr.create,fu=ne.create,pu=L.create,mu=L.strictCreate,gu=kt.create,vu=Cr.create,yu=St.create,bu=ce.create,_u=Nt.create,xu=hr.create,wu=Fe.create,ju=Ye.create,ku=Ct.create,Su=Et.create,Nu=Ce.create,Cu=Ot.create,Eu=st.create,Ms=ie.create,Ou=oe.create,Tu=Ee.create,Pu=ie.createWithPreprocess,Au=Ut.create,Ru=()=>Wn().optional(),$u=()=>Jn().optional(),Iu=()=>Gn().optional(),Du={string:s=>se.create({...s,coerce:!0}),number:s=>Se.create({...s,coerce:!0}),boolean:s=>xt.create({...s,coerce:!0}),bigint:s=>Ne.create({...s,coerce:!0}),date:s=>Ue.create({...s,coerce:!0})},Lu=S;var D=Object.freeze({__proto__:null,defaultErrorMap:tt,setErrorMap:Lc,getErrorMap:or,makeIssue:lr,EMPTY_PATH:Uc,addIssueToContext:y,ParseStatus:z,INVALID:S,DIRTY:He,OK:V,isAborted:Jr,isDirty:Gr,isValid:bt,isAsync:_t,get util(){return A},get objectUtil(){return Wr},ZodParsedType:b,getParsedType:ke,ZodType:E,datetimeRegex:Vn,ZodString:se,ZodNumber:Se,ZodBigInt:Ne,ZodBoolean:xt,ZodDate:Ue,ZodSymbol:ur,ZodUndefined:wt,ZodNull:jt,ZodAny:rt,ZodUnknown:Le,ZodNever:fe,ZodVoid:dr,ZodArray:ne,ZodObject:L,ZodUnion:kt,ZodDiscriminatedUnion:Cr,ZodIntersection:St,ZodTuple:ce,ZodRecord:Nt,ZodMap:hr,ZodSet:Fe,ZodFunction:Ye,ZodLazy:Ct,ZodLiteral:Et,ZodEnum:Ce,ZodNativeEnum:Ot,ZodPromise:st,ZodEffects:ie,ZodTransformer:ie,ZodOptional:oe,ZodNullable:Ee,ZodDefault:Tt,ZodCatch:Pt,ZodNaN:fr,BRAND:eu,ZodBranded:cs,ZodPipeline:Ut,ZodReadonly:At,custom:Hn,Schema:E,ZodSchema:E,late:tu,get ZodFirstPartyTypeKind(){return k},coerce:Du,any:cu,array:fu,bigint:nu,boolean:Gn,date:iu,discriminatedUnion:vu,effect:Ms,enum:Nu,function:ju,instanceof:ru,intersection:yu,lazy:ku,literal:Su,map:xu,nan:su,nativeEnum:Cu,never:du,null:lu,nullable:Tu,number:Jn,object:pu,oboolean:Iu,onumber:$u,optional:Ou,ostring:Ru,pipeline:Au,preprocess:Pu,promise:Eu,record:_u,set:wu,strictObject:mu,string:Wn,symbol:au,transformer:Ms,tuple:bu,undefined:ou,union:gu,unknown:uu,void:hu,NEVER:Lu,ZodIssueCode:g,quotelessJson:Dc,ZodError:Y});const Uu=/^\+?[\d\s-()]{10,}$/,Fu=D.object({brand_id:D.string().uuid("Invalid brand selected"),make:D.string().min(1,"Make is required"),model:D.string().min(1,"Model is required"),year:D.number().min(1900,"Year must be 1900 or later").max(new Date().getFullYear()+1,"Invalid year"),price:D.number().positive("Price must be greater than 0"),image:D.string().url("Please upload at least one image"),video_url:D.string().url("Invalid video URL").optional().nullable(),condition:D.literal("used"),mileage:D.string().min(1,"Mileage is required"),fuel_type:D.string().min(1,"Fuel type is required"),transmission:D.string().min(1,"Transmission is required"),body_type:D.string().min(1,"Body type is required"),exterior_color:D.string().min(1,"Exterior color is required"),interior_color:D.string().min(1,"Interior color is required"),number_of_owners:D.number().positive("Number of owners must be greater than 0"),client_name:D.string().min(2,"Name must be at least 2 characters"),client_phone:D.string().regex(Uu,"Invalid phone number format. Please include country code."),client_city:D.string().min(2,"City must be at least 2 characters")});async function Mu(s){try{const e=Fu.parse({...s,video_url:s.video_url||null}),t=e.client_phone.replace(/\s+/g," ").trim(),{data:r,error:n}=await $.from("private_listings").insert([{...e,client_phone:t,status:"pending"}]).select().single();if(n)throw console.error("Database error:",n),n.code==="23503"?new Error("Invalid brand selected"):n.code==="23514"?new Error("Please check all required fields"):n.code==="23505"?new Error("This listing already exists"):new Error("Failed to submit listing. Please try again.");return Ga.success("Car listing submitted successfully!"),r}catch(e){if(console.error("Submission error:",e),e instanceof D.ZodError){const t=e.errors[0];throw new Error(t.message)}throw e instanceof Error?e:new Error("Failed to submit car listing. Please try again.")}}const qu=["Petrol","Diesel","Electric","Hybrid"],Bu=["Automatic","Manual"],Zu=["Sedan","SUV","Coupe","Hatchback","Convertible","Van"],qs=["Black","White","Silver","Blue","Red","Grey","Green","Brown","Beige"];function Qu(){const{data:s,isLoading:e}=ls(),[t,r]=_.useState({brand_id:"",make:"",model:"",year:new Date().getFullYear(),price:0,image:"",condition:"used",mileage:"",fuel_type:"Petrol",transmission:"Automatic",body_type:"Sedan",exterior_color:"Black",interior_color:"Black",number_of_owners:1,client_name:"",client_phone:"",client_city:""}),[n,i]=_.useState(!1),[a,o]=_.useState(null),[c,u]=_.useState(!1),d=async f=>{f.preventDefault(),i(!0),o(null);try{if(!t.brand_id)throw new Error("Please select a brand");if(!t.image)throw new Error("Please upload at least one image");if(!t.client_name||!t.client_phone||!t.client_city)throw new Error("Please fill in all contact information");await Mu(t),u(!0),window.scrollTo(0,0)}catch(p){console.error("Error submitting car:",p),o(p instanceof Error?p.message:"Failed to submit car. Please try again."),window.scrollTo(0,0)}finally{i(!1)}},h=f=>{const{name:p,value:m,type:v}=f.target;if(r(x=>({...x,[p]:v==="number"?Number(m):m})),p==="brand_id"){const x=s==null?void 0:s.find(w=>w.id===m);x&&r(w=>({...w,brand_id:m,make:x.name}))}};return c?l.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:l.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-green-600 mb-4",children:"Thank you for your submission!"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Your car listing has been submitted successfully. Our team will review it and get back to you soon."}),l.jsx("button",{onClick:()=>window.location.href="/",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Return to Home"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 py-12",children:[l.jsx(fn,{position:"top-right"}),l.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Sell Your Car"}),a&&l.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:a}),l.jsxs("form",{onSubmit:d,className:"space-y-8",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Contact Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Name"}),l.jsx("input",{type:"text",name:"client_name",value:t.client_name,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),l.jsx("input",{type:"tel",name:"client_phone",value:t.client_phone,onChange:h,placeholder:"+1234567890",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),l.jsx("input",{type:"text",name:"client_city",value:t.client_city,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Car Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Brand"}),l.jsxs("select",{name:"brand_id",value:t.brand_id,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[l.jsx("option",{value:"",children:"Select a brand"}),s==null?void 0:s.map(f=>l.jsx("option",{value:f.id,children:f.name},f.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model"}),l.jsx("input",{type:"text",name:"model",value:t.model,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),l.jsx("input",{type:"number",name:"year",value:t.year,onChange:h,min:"1900",max:new Date().getFullYear()+1,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (£)"}),l.jsx("input",{type:"number",name:"price",value:t.price,onChange:h,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mileage"}),l.jsx("input",{type:"text",name:"mileage",value:t.mileage,onChange:h,placeholder:"e.g., 50,000 km",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Previous Owners"}),l.jsx("input",{type:"number",name:"number_of_owners",value:t.number_of_owners,onChange:h,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Technical Specifications"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Type"}),l.jsx("select",{name:"fuel_type",value:t.fuel_type,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:qu.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transmission"}),l.jsx("select",{name:"transmission",value:t.transmission,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:Bu.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Body Type"}),l.jsx("select",{name:"body_type",value:t.body_type,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:Zu.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exterior Color"}),l.jsx("select",{name:"exterior_color",value:t.exterior_color,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:qs.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interior Color"}),l.jsx("select",{name:"interior_color",value:t.interior_color,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:qs.map(f=>l.jsx("option",{value:f,children:f},f))})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Images and Video"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Main Image"}),l.jsx($c,{onImageUploaded:f=>r(p=>({...p,image:f})),className:"mb-4"}),t.image&&l.jsx("img",{src:t.image,alt:"Car preview",className:"w-full h-48 object-cover rounded-md"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Video (Optional)"}),l.jsx(Ic,{onVideoUploaded:f=>r(p=>({...p,video_url:f})),existingVideo:t.video_url,onVideoRemoved:()=>r(f=>({...f,video_url:void 0}))})]})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:n?"Submitting...":"Submit Listing"})})]})]})})]})}const zu="m.amine@me.com",Vu=D.object({email:D.string().email("Invalid email address"),password:D.string().min(6,"Password must be at least 6 characters")});function Ku(){const[s,e]=_.useState({email:zu,password:""}),[t,r]=_.useState(""),[n,i]=_.useState(!1),a=nt(),o=Qs(),{signIn:c}=Nr(),u=async d=>{var h,f;d.preventDefault(),r(""),i(!0);try{const p=Vu.parse(s);await c(p.email,p.password);const m=((f=(h=o.state)==null?void 0:h.from)==null?void 0:f.pathname)||"/admin/dashboard";a(m,{replace:!0})}catch(p){console.error("Login error:",p),p instanceof D.ZodError?r(p.errors[0].message):p instanceof Error?r(p.message):r("An unexpected error occurred")}finally{i(!1)}};return l.jsx("div",{className:"min-h-[calc(100vh-4rem)] flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"max-w-md w-full space-y-8",children:[l.jsxs("div",{children:[l.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100",children:l.jsx(xi,{className:"h-6 w-6 text-blue-600"})}),l.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Admin Login"}),l.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in with your admin credentials"})]}),t&&l.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[l.jsx("p",{className:"font-medium",children:"Error"}),l.jsx("p",{className:"text-sm",children:t})]}),l.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[l.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),l.jsx("input",{id:"email",type:"email",value:s.email,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm bg-gray-50",readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),l.jsx("input",{id:"password",type:"password",value:s.password,onChange:d=>e(h=>({...h,password:d.target.value})),placeholder:"Enter your password",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",required:!0})]})]}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:n,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:n?l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Sign in"})})]})]})})}function Hu(){const s=nt(),[e,t]=_.useState([]),[r,n]=_.useState(!0),[i,a]=_.useState(null);_.useEffect(()=>{o()},[]);async function o(){try{n(!0);const h=await kc();t(h||[])}catch(h){console.error("Error loading cars:",h),a("Failed to load cars. Please try again.")}finally{n(!1)}}const c=async h=>{if(confirm("Are you sure you want to delete this car?"))try{await Nc(h),t(e.filter(f=>f.id!==h))}catch(f){console.error("Error deleting car:",f),alert("Failed to delete car. Please try again.")}},u=h=>{s(`/admin/dashboard/cars/edit/${h}`)},d=async h=>{try{const f=await Mn(h.id,{is_sold:!h.is_sold});t(e.map(p=>p.id===h.id?f:p))}catch(f){console.error("Error updating car:",f),alert("Failed to update car status. Please try again.")}};return r?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Car Listings"}),l.jsxs("button",{onClick:()=>s("/admin/dashboard/cars/new"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:[l.jsx(Js,{className:"h-5 w-5"}),"Add New Car"]})]}),i&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:i}),l.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Make"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Model"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Year"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.map(h=>l.jsxs("tr",{className:`hover:bg-gray-50 relative ${h.is_sold?"opacity-75":""}`,children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:h.image,alt:`${h.make} ${h.model}`,className:"h-12 w-16 object-cover rounded"}),h.is_sold&&l.jsx("div",{className:"absolute inset-0 bg-red-600 bg-opacity-50 flex items-center justify-center rounded",children:l.jsx("span",{className:"text-white font-bold transform -rotate-45",children:"SOLD"})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.make}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.model}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.year}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["£",h.price.toLocaleString()]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${h.condition==="new"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:h.condition.charAt(0).toUpperCase()+h.condition.slice(1)})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>u(h.id),className:"text-blue-600 hover:text-blue-900 transition-colors p-1 rounded hover:bg-blue-50",title:"Edit car",children:l.jsx(wi,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>d(h),className:`${h.is_sold?"text-green-600 hover:text-green-900":"text-orange-600 hover:text-orange-900"} transition-colors p-1 rounded hover:bg-orange-50`,title:h.is_sold?"Mark as available":"Mark as sold",children:l.jsx(ji,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>c(h.id),className:"text-red-600 hover:text-red-900 transition-colors p-1 rounded hover:bg-red-50",title:"Delete car",children:l.jsx(ki,{className:"h-5 w-5"})})]})})]},h.id)),e.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"No cars found. Add your first car listing!"})})]})]})})})]})}const Wu=["Speed Regulator","Air Condition","Reversing Camera","Reversing Radar","GPS Navigation","Park Assist","Start and Stop","Airbag","ABS","Computer","Rims","Electric mirrors","Electric windows","Bluetooth"],Ju={brand_id:"",make:"",model:"",year:new Date().getFullYear(),price:0,image:"",video_url:"",savings:0,condition:"new",is_sold:!1,mileage:"",fuel_type:"Petrol",transmission:"Automatic",autonomy:"",seats:5,body_type:"Sedan",exterior_color:"Black",interior_color:"Black",number_of_owners:1,number_of_keys:"2"};function Bs(){const{id:s}=Zs(),e=nt(),{data:t,isLoading:r}=ls(),[n,i]=_.useState(Ju),[a,o]=_.useState(new Set(Wu)),[c,u]=_.useState(!1),[d,h]=_.useState(null),[f,p]=_.useState(!1);_.useEffect(()=>{s&&m(s)},[s]);async function m(x){try{p(!0);const w=await Fn(x);if(w){const{id:T,created_at:C,updated_at:M,brand:q,images:U,features:pe,...ot}=w;i(ot),pe&&o(new Set(pe.filter(me=>me.available).map(me=>me.name)))}}catch(w){console.error("Error loading car:",w),h("Failed to load car details"),B.error("Failed to load car details")}finally{p(!1)}}const v=async x=>{x.preventDefault(),u(!0),h(null);try{if(!n.brand_id)throw new Error("Please select a brand");const w={...n,features:Array.from(a).map(T=>({name:T,available:!0}))};s?(await Mn(s,w),B.success("Car updated successfully")):(await Sc(w),B.success("Car created successfully")),e("/admin/dashboard/cars")}catch(w){console.error("Error saving car:",w);const T=w instanceof Error?w.message:"Failed to save car. Please try again.";h(T),B.error(T)}finally{u(!1)}};return f||r?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"p-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:s?"Edit Car":"Add New Car"}),d&&l.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",children:d}),l.jsx("form",{onSubmit:v,className:"space-y-8"})]})}class We extends Error{constructor(e,t,r){super(e),this.code=t,this.details=r,this.name="AppError"}}function Yn(s,e){return s instanceof We?s:s instanceof Error?new We(s.message):Gu(s)?new We(Yu(s)||e,s.code,s.details):new We(e)}function Gu(s){return typeof s=="object"&&s!==null&&"code"in s}function Yu(s){switch(s.code){case"23503":return"Referenced record not found";case"23505":return"Record already exists";case"23514":return"Invalid data provided";default:return s.message}}async function Xu(){try{const{data:s,error:e}=await $.from("private_listings").select(`
        *,
        brand:brands (
          id,
          name,
          logo_url
        )
      `).order("created_at",{ascending:!1});if(e)throw e;return s}catch(s){throw Yn(s,"Failed to fetch listings")}}async function ed(s,e){try{const{data:t,error:r}=await $.rpc("process_private_listing",{p_listing_id:s,p_status:e});if(r)throw r;if(!(t!=null&&t.success))throw new Error("Failed to process listing");return t}catch(t){throw Yn(t,`Failed to ${e} listing`)}}function td({listing:s,onClose:e,onApprove:t,onReject:r,isUpdating:n}){return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Car Details"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-500",children:l.jsx(pr,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"mt-6 space-y-6",children:[l.jsx("div",{children:l.jsx("img",{src:s.image,alt:`${s.make} ${s.model}`,className:"w-full h-64 object-cover rounded-lg"})}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Client Information"}),l.jsxs("p",{className:"text-gray-600",children:["Name: ",s.client_name]}),l.jsxs("p",{className:"text-gray-600",children:["Phone: ",s.client_phone]}),l.jsxs("p",{className:"text-gray-600",children:["City: ",s.client_city]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Car Information"}),l.jsxs("p",{className:"text-gray-600",children:[s.year," ",s.make," ",s.model]}),l.jsxs("p",{className:"text-gray-600",children:["Price: £",s.price.toLocaleString()]}),l.jsxs("p",{className:"text-gray-600",children:["Mileage: ",s.mileage]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Technical Details"}),l.jsxs("p",{className:"text-gray-600",children:["Fuel Type: ",s.fuel_type]}),l.jsxs("p",{className:"text-gray-600",children:["Transmission: ",s.transmission]}),l.jsxs("p",{className:"text-gray-600",children:["Body Type: ",s.body_type]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Additional Details"}),l.jsxs("p",{className:"text-gray-600",children:["Exterior Color: ",s.exterior_color]}),l.jsxs("p",{className:"text-gray-600",children:["Interior Color: ",s.interior_color]}),l.jsxs("p",{className:"text-gray-600",children:["Previous Owners: ",s.number_of_owners]})]})]}),s.video_url&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Video"}),l.jsx("video",{src:s.video_url,controls:!0,className:"w-full rounded-lg",children:"Your browser does not support the video tag."})]}),s.status==="pending"&&t&&r&&l.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[l.jsx("button",{onClick:t,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"Approve"}),l.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:"Reject"})]})]})]})})})}function rd({status:s}){const e={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e[s]}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function sd(){const s=cn(),[e,t]=_.useState(null),[r,n]=_.useState(!1),{data:i,isLoading:a,error:o}=vr("privateListings",Xu,{retry:2,onError:u=>{console.error("Failed to fetch listings:",u),B.error(u instanceof We?u.message:"Failed to load listings")}}),c=async(u,d)=>{if(!(!u||r))try{n(!0),await ed(u,d),await Promise.all([s.invalidateQueries("privateListings"),s.invalidateQueries("cars")]),B.success(d==="approved"?"Listing approved and published successfully":"Listing rejected successfully"),t(null)}catch(h){console.error("Error updating status:",h),B.error(h instanceof We?h.message:"Failed to update listing status")}finally{n(!1)}};return a?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[l.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load listings"}),l.jsx("button",{onClick:()=>s.invalidateQueries("privateListings"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Try Again"})]}):l.jsxs("div",{className:"p-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Private Car Listings"}),l.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client Details"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Car Details"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[i==null?void 0:i.map(u=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:u.client_name}),l.jsx("div",{className:"text-sm text-gray-500",children:u.client_phone}),l.jsx("div",{className:"text-sm text-gray-500",children:u.client_city})]}),l.jsxs("td",{className:"px-6 py-4",children:[l.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[u.year," ",u.make," ",u.model]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[u.mileage," • ",u.fuel_type," • ",u.transmission]})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["£",u.price.toLocaleString()]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx(rd,{status:u.status})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("button",{onClick:()=>t(u),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"View details",children:l.jsx(Si,{className:"h-5 w-5"})}),u.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>c(u.id,"approved"),disabled:r,className:"text-green-600 hover:text-green-900 transition-colors disabled:opacity-50",title:"Approve and publish listing",children:l.jsx(Hs,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>c(u.id,"rejected"),disabled:r,className:"text-red-600 hover:text-red-900 transition-colors disabled:opacity-50",title:"Reject listing",children:l.jsx(pr,{className:"h-5 w-5"})})]})]})})]},u.id)),!(i!=null&&i.length)&&l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No private listings found"})})]})]})})}),e&&l.jsx(td,{listing:e,onClose:()=>t(null),onApprove:e.status==="pending"?()=>c(e.id,"approved"):void 0,onReject:e.status==="pending"?()=>c(e.id,"rejected"):void 0,isUpdating:r})]})}function nd(){const s=nt(),{signOut:e}=Nr(),t=async()=>{await e(),s("/admin/login")};return l.jsxs("div",{className:"flex h-[calc(100vh-4rem)]",children:[l.jsxs("div",{className:"w-64 bg-white shadow-md",children:[l.jsx("div",{className:"p-4",children:l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Admin Panel"})}),l.jsxs("nav",{className:"mt-4",children:[l.jsxs(Je,{to:"/admin/dashboard/cars",className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[l.jsx(Xr,{className:"h-5 w-5 mr-2"}),"Car Listings"]}),l.jsxs(Je,{to:"/admin/dashboard/cars/new",className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[l.jsx(Js,{className:"h-5 w-5 mr-2"}),"Add New Car"]}),l.jsxs(Je,{to:"/admin/dashboard/private-listings",className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[l.jsx(Ni,{className:"h-5 w-5 mr-2"}),"Private Listings"]}),l.jsxs("button",{onClick:t,className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 w-full",children:[l.jsx(Vs,{className:"h-5 w-5 mr-2"}),"Logout"]})]})]}),l.jsx("div",{className:"flex-1 bg-gray-50 p-8 overflow-y-auto",children:l.jsxs(zs,{children:[l.jsx(G,{index:!0,element:l.jsx(vt,{to:"cars",replace:!0})}),l.jsx(G,{path:"cars",element:l.jsx(Hu,{})}),l.jsx(G,{path:"cars/new",element:l.jsx(Bs,{})}),l.jsx(G,{path:"cars/edit/:id",element:l.jsx(Bs,{})}),l.jsx(G,{path:"private-listings",element:l.jsx(sd,{})}),l.jsx(G,{path:"*",element:l.jsx(vt,{to:"cars",replace:!0})})]})})]})}function id({children:s}){const{user:e,isLoading:t}=Nr(),r=Qs();return t?l.jsx("div",{className:"flex justify-center items-center h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e?l.jsx(l.Fragment,{children:s}):l.jsx(vt,{to:"/admin/login",state:{from:r},replace:!0})}const ad=new Gi({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function od(){return l.jsx(ra,{client:ad,children:l.jsx(dc,{children:l.jsx(si,{children:l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx(fn,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}}),l.jsx(hc,{}),l.jsxs(zs,{children:[l.jsx(G,{path:"/",element:l.jsx(jc,{})}),l.jsx(G,{path:"/cars/:id",element:l.jsx(Pc,{})}),l.jsx(G,{path:"/sell-your-car",element:l.jsx(Qu,{})}),l.jsx(G,{path:"/admin/login",element:l.jsx(Ku,{})}),l.jsx(G,{path:"/admin",element:l.jsx(vt,{to:"/admin/dashboard",replace:!0})}),l.jsx(G,{path:"/admin/dashboard/*",element:l.jsx(id,{children:l.jsx(nd,{})})}),l.jsx(G,{path:"*",element:l.jsx(vt,{to:"/",replace:!0})})]})]})})})})}Xs(document.getElementById("root")).render(l.jsx(_.StrictMode,{children:l.jsx(od,{})}));
//# sourceMappingURL=index-BEkKWzn5.js.map
